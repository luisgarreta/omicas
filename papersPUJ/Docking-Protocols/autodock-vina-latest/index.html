<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Autodock Vina 1.2.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="canonical" href="https://autodock-vina.readthedocs.io/en/latest/index.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> Autodock Vina
          </a>
              <div class="version">
                latest
              </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-introduction">About AutoDock Vina</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-faq">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-citations">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-changes">Changes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_requirements">Software requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_basic">Basic docking</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_flexible">Flexible docking</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_multiple_ligands">Multiple ligands docking</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_zinc">Docking with zinc metalloproteins</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_hydrated">Hydrated docking</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_macrocycle">Docking with macrocycles</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docking_python">Python scripting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-vina">AutoDock Vina</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Autodock Vina</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Autodock Vina 1.2.0 documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ccsb-scripps/AutoDock-Vina/blob/develop/docs/source/index" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="autodock-vina-molecular-docking-program">
<h1>AutoDock Vina: Molecular docking program<a class="headerlink" href="#autodock-vina-molecular-docking-program" title="Permalink to this headline"></a></h1>
<p><strong>AutoDock Vina</strong> is one of the <strong>fastest</strong> and <strong>most widely used</strong> <strong>open-source</strong> docking engines. It is a turnkey computational docking program that is based on a simple scoring function and rapid gradient-optimization conformational search. It was originally designed and implemented by Dr. Oleg Trott in the Molecular Graphics Lab, and it is now being maintained and develop by the Forli Lab at The Scripps Research Institute.</p>
<p>Vina’s design philosophy is not to require the user to understand its implementation details, tweak obscure search parameters, cluster results or know advanced algebra (quaternions). All that is required is the structures of the molecules being docked and the specification of the search space including the binding site. Calculating grid maps and assigning atom charges is not needed (when using Vina or Vinardo forcefields). Like in AutoDock 4, some receptor side chains can be chosen to be treated as flexible during docking. Additionally, it takes advantage of multiple CPUs or CPU cores on your system to significantly shorten its running time, which makes it faster than AutoDock 4 by <em>orders of magnitude</em>. Moreover, it significantly improves the average accuracy of the binding mode predictions compared to AutoDock 4.</p>
<section id="availability">
<h2>Availability<a class="headerlink" href="#availability" title="Permalink to this headline"></a></h2>
<p>AutoDock Vina can be easily installed with all its dependencies using <cite>pip</cite> or <cite>conda</cite> package managers.</p>
<p>All <strong>source code</strong> is available under the <a class="reference external" href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, version 2.0</a> from <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina">github.com/ccsb-scripps/AutoDock-Vina</a> and the Python Package index <a class="reference external" href="pypi.org/project/Vina">pypi.org/project/Vina</a>.</p>
</section>
<section id="participating">
<h2>Participating<a class="headerlink" href="#participating" title="Permalink to this headline"></a></h2>
<p>Please report bugs or enhancement requests through the <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/issues">Issue Tracker</a>.</p>
<p>AutoDock Vina is <strong>open source</strong> and welcomes your contributions. <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina">Fork the repository on GitHub</a> and submit a pull request. Participate on the <a class="reference external" href="http://mgldev.scripps.edu/mailman/listinfo/autodock">developer mailing list</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-introduction"></span><section id="about-autodock-vina">
<h3>About AutoDock Vina<a class="headerlink" href="#about-autodock-vina" title="Permalink to this headline"></a></h3>
<p><strong>AutoDock Vina</strong> (Vina) is one of the docking engines in the AutoDock Suite, together with <strong>AutoDock4</strong> (AD4), <strong>AutoDockGPU</strong>, <strong>AutoDockFR</strong>, and <strong>AutoDock-CrankPep</strong>, and arguably among the <strong>most widely used and successful docking engines</strong>. The reasons for this success are mostly due to its ease of use and its speed (up to 100x faster than AD4), when compared to the other docking engines in the suite and elsewhere, as well as being open source. The source code is available at <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina">https://github.com/ccsb-scripps/AutoDock-Vina</a>.</p>
<p>Research groups around the world have modified and built upon the Vina source code, improving the search algorithm (<strong>QuickVina2</strong>), made the interface more user friendly and allow modification of scoring terms through the user interface (<strong>Smina</strong>), and improved the scoring function for carbohydrate docking (<strong>Vina-Carb</strong>), halogen bonds (<strong>VinaXB</strong>) and created an improved scoring function (<strong>Vinardo</strong>).</p>
<p>Over the years many specialized docking methods were developed for AutoDock 4 but were never ported to AutoDock Vina. This happened because AutoDock 4 allows the user to modify a large number of docking parameters, providing direct access to some of the engine internals, with benefits in terms of flexibility and adaptability. Conversely, the Vina code is highly optimized and specialized, and one of its hallmarks is the very limited amount of user input necessary to perform a docking, making it harder to implement additional functionality, which requires changes to the source code. However, some of the specialized docking methods are now available in Vina (v1.2.x) such as <strong>macrocyclic flexibility</strong>, <strong>specialized metal coordination models</strong>, <strong>explicit waters hydrated</strong> and <strong>simultaneous docking of multiple ligands</strong>. Vina was further extended by adding <strong>Python bindings</strong> to facilitate programmatic access to the docking engine functions.</p>
</section>
<span id="document-installation"></span><section id="installation">
<span id="id1"></span><h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently, the python bindings and the binary installation are two separate processes. The installation of the python bindings does not include the Vina executable, and vice versa.</p>
</div>
<section id="unix-and-linux-based-os">
<h4>Unix- and Linux-based OS<a class="headerlink" href="#unix-and-linux-based-os" title="Permalink to this headline"></a></h4>
<p>Vina is expected to work on x86 and compatible 64-bit Linux systems. The executable for the latest release are available here: <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/releases">https://github.com/ccsb-scripps/AutoDock-Vina/releases</a>.</p>
<p><strong>Running</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./vina_1.2.0_linux_x86_64 --help
</pre></div>
</div>
<p>If the executable is in your PATH, you can just type “vina –help” instead.</p>
</section>
<section id="macos">
<h4>macOS<a class="headerlink" href="#macos" title="Permalink to this headline"></a></h4>
<p>Vina is expected to work on macOS 10.15 (Catalina) and newer. The executable for the latest release are available here: <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/releases">https://github.com/ccsb-scripps/AutoDock-Vina/releases</a>.</p>
<p><strong>Running</strong>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./vina_1.2.0_macos_x86_64 --help
</pre></div>
</div>
<p>If the executable is in your PATH, you can just type “vina –help” instead.</p>
</section>
<section id="python-bindings">
<h4>Python bindings<a class="headerlink" href="#python-bindings" title="Permalink to this headline"></a></h4>
<p>Currently working on Linux and Mac. We did not test on Windows.</p>
<p><strong>AutoDock Vina installation using pip</strong>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">pip</span></code>, it’s good pratice to use a virtual environment and also the easiest solution (see <code class="docutils literal notranslate"><span class="pre">meeko</span></code> in <a class="reference internal" href="index.html#docking-requirements"><span class="std std-ref">Software requirements</span></a>). An example with the <a class="reference external" href="https://docs.conda.io/en/latest/">Conda package manager</a> is available further down.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install -U numpy vina
</pre></div>
</div>
<p><strong>AutoDock Vina installation in a Conda environment</strong>:</p>
<p>The Anaconda Python distribution, which can be download from <a class="reference external" href="https://docs.continuum.io/anaconda/install/">https://docs.continuum.io/anaconda/install</a>. This is a Python distribution specially designed for scientific applications, with many of the most popular scientific packages preinstalled. Alternatively, you can use <a class="reference external" href="https://conda.pydata.org/miniconda.html">Miniconda</a>, which includes only Python itself, plus the Conda package manager.</p>
<ol class="arabic simple">
<li><p>Begin by installing the most recent 64 bit, Python 3.x version of either Anaconda or Miniconda</p></li>
<li><p>Create a dedicated environment for <code class="docutils literal notranslate"><span class="pre">AutoDock</span> <span class="pre">Vina</span></code>. This environment can be re-used for installing <code class="docutils literal notranslate"><span class="pre">meeko</span></code> (see <a class="reference internal" href="index.html#docking-requirements"><span class="std std-ref">Software requirements</span></a>):</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conda create -n vina <span class="nv">python</span><span class="o">=</span><span class="m">3</span>
$ conda activate vina
$ conda config --env --add channels conda-forge
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>And type the following command to install <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> and <code class="docutils literal notranslate"><span class="pre">AutoDock</span> <span class="pre">Vina</span></code>:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conda install numpy
$ pip install vina
</pre></div>
</div>
</section>
<section id="building-from-source">
<h4>Building from Source<a class="headerlink" href="#building-from-source" title="Permalink to this headline"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Building Vina from source is NOT meant to be done by regular users!</p>
</div>
<ul>
<li><dl class="simple">
<dt>Step 1: <strong>Install a C++ compiler suite</strong></dt><dd><ul class="simple">
<li><p>Ubuntu/Debian: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">build-essentials</span></code></p></li>
<li><p>macOS: Install Xcode from the <a class="reference external" href="https://apps.apple.com/fr/app/xcode/id497799835?mt=12">AppStore</a> and the Command Line Tools (CLT) from the terminal <code class="docutils literal notranslate"><span class="pre">xcode-select</span> <span class="pre">--install</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Step 2: <strong>Install Boost and SWIG</strong></dt><dd><ul class="simple">
<li><p>Ubuntu/Debian: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">libboost-all-dev</span> <span class="pre">swig</span></code></p></li>
<li><p>macOS (with <a class="reference external" href="https://brew.sh">Homebrew</a>): <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">boost</span> <span class="pre">swig</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Step 3: <strong>Build Vina</strong></p>
<blockquote>
<div><p>Start by downloading the lastest version of <code class="docutils literal notranslate"><span class="pre">AutoDock</span> <span class="pre">Vina</span></code> from github:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/ccsb-scripps/AutoDock-Vina
</pre></div>
</div>
<p>To compile the binary (you might need to customize the Makefile by setting the paths to the Boost library):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> AutoDock-Vina/build/linux/release
$ make
</pre></div>
</div>
<p>To compile the Python bindings:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Conda</span></code> package manager is used here to easily install the several dependencies needed to build the <code class="docutils literal notranslate"><span class="pre">Autodock-Vina</span></code> python bindings (see above how to create a dedicated environment).</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conda activate vina
$ <span class="nb">cd</span> AutoDock-Vina/build/python
$ conda install -c conda-forge numpy boost-cpp swig
$ rm -rf build dist *.egg-info <span class="o">(</span>to clean previous installation<span class="o">)</span>
$ python setup.py build install
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
</section>
<span id="document-faq"></span><section id="frequently-asked-questions">
<h3>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline"></a></h3>
<ul class="simple">
<li><p><strong>How accurate is AutoDock Vina?</strong></p></li>
</ul>
<p>The predictive accuracy varies a lot depending on the target, so it makes sense to evaluate AutoDock Vina against your particular target first, if you have known actives, or a bound native ligand structure, before ordering compounds. While evaluating any docking engine in a retrospective virtual screen, it might make sense to select decoys of similar size, and perhaps other physical characteristics, to your known actives.</p>
<ul class="simple">
<li><p><strong>What is the difference between AutoDock Vina and AutoDock 4?</strong></p></li>
</ul>
<p>AutoDock 4 (and previous versions) and AutoDock Vina were both developed in the Molecular Graphics Lab at The Scripps Research Institute. AutoDock Vina inherits some of the ideas and approaches of AutoDock 4, such as treating docking as a stochastic global opimization of the scoring function, precalculating grid maps (Vina does that internally), and some other implementation tricks, such as precalculating the interaction between every atom type pair at every distance. It also uses the same type of structure format (PDBQT) for maximum compatibility with auxiliary software.</p>
<p>However, the source code, the scoring funcion and the actual algorithms used are brand new, so it’s more correct to think of AutoDock Vina as a new “generation” rather than “version” of AutoDock. The performance was compared in the original publication [*], and on average, AutoDock Vina did considerably better, both in speed and accuracy. However, for any given target, either program may provide a better result, even though AutoDock Vina is more likely to do so. This is due to the fact that the scoring functions are different, and both are inexact.</p>
<ul class="simple">
<li><p><strong>What is the difference between AutoDock Vina and AutoDock Tools?</strong></p></li>
</ul>
<p>AutoDock Tools is a module within the MGL Tools software package specifically for generating input (PDBQT files) for AutoDock or Vina. It can also be used for viewing the results.</p>
<ul class="simple">
<li><p><strong>Can I dock two proteins with AutoDock Vina?</strong></p></li>
</ul>
<p>You might be able to do that, but AutoDock Vina is designed only for receptor-ligand docking. There are better programs for protein-protein docking.</p>
<ul class="simple">
<li><p><strong>Will Vina run on my 64-bit machine?</strong></p></li>
</ul>
<p>Yes. By design, modern 64-bit machines can run 32-bit binaries natively.</p>
<ul class="simple">
<li><p><strong>Why do I get “can not open conf.txt” error? The file exists!</strong></p></li>
</ul>
<p>Oftentimes, file browsers hide the file extension, so while you think you have a file “conf.txt”, it’s actually called “conf.txt.txt”. This setting can be changed in the control panel or system preferences.</p>
<p>You should also make sure that the file path you are providing is correct with respect to the directory (folder) you are in, e.g. if you are referring simply to conf.txt in the command line, make sure you are in the same directory (folder) as this file. You can use ls or dir commands on Linux/MacOS and Windows, respectively, to list the contents of your directory.</p>
<ul class="simple">
<li><p><strong>Why do I get “usage errors” when I try to follow the video tutorial?</strong></p></li>
</ul>
<p>The command line options changed somewhat since the tutorial has been recorded. In particular, “–out” replaced “–all”.</p>
<ul class="simple">
<li><p><strong>Vina runs well on my machine, but when I run it on my exotic Linux cluster, I get a “boost thread resource” error. Why?</strong></p></li>
</ul>
<p>Your Linux cluster is [inadvertantly] configured in such a way as to disallow spawning threads. Therefore, Vina can not run. Contact your system administrator.</p>
<ul class="simple">
<li><p><strong>Why is my docked conformation different from what you get in the video tutorial?</strong></p></li>
</ul>
<p>The docking algorithm is non-deterministic. Even though with this receptor-ligand pair, the minimum of the scoring function corresponds to the correct conformation, the docking algorithm sometimes fails to find it. Try several times and see for yourself. Note that the probability of failing to find the mininum may be different with a different system.</p>
<ul class="simple">
<li><p><strong>My docked conformation is the same, but my energies are different from what you get in the video tutorial. Why?</strong></p></li>
</ul>
<p>The scoring function has changed since the tutorial was recorded, but only in the part that is independent of the conformation: the ligand-specific penalty for flexibility has changed.</p>
<ul class="simple">
<li><p><strong>Why do my results look weird in PyMOL?</strong></p></li>
</ul>
<p>PDBQT is not a standard molecular structure format. The version of PyMOL used in the tutorial (0.99rc6) happens to display it well (because PDBQT is somewhat similar to PDB). This might not be the case for newer versions of PyMOL.</p>
<ul class="simple">
<li><p><strong>Any other way to view the results?</strong></p></li>
</ul>
<p>You can also view PDBQT files in PMV (part of MGL Tools), or convert them into a different file format (e.g. using AutoDock Tools, or with “save as” in PMV)</p>
<ul class="simple">
<li><p><strong>How big should the search space be?</strong></p></li>
</ul>
<p>As small as possible, but not smaller. The smaller the search space, the easier it is for the docking algorithm to explore it. On the other hand, it will not explore ligand and flexible side chain atom positions outside the search space. You should probably avoid search spaces bigger than 30 x 30 x 30 Angstrom, unless you also increase “–exhaustiveness”.</p>
<ul class="simple">
<li><p><strong>Why am I seeing a warning about the search space volume being over 27000 Angstrom^3?</strong></p></li>
</ul>
<p>This is probably because you intended to specify the search space sizes in “grid points” (0.375 Angstrom), as in AutoDock 4. The AutoDock Vina search space sizes are given in Angstroms instead. If you really intended to use an unusually large search space, you can ignore this warning, but note that the search algorithm’s job may be harder. You may need to increase the value of the exhaustiveness to make up for it. This will lead to longer run time.</p>
<ul class="simple">
<li><p><strong>The bound conformation looks reasonable, except for the hydrogens. Why?</strong></p></li>
</ul>
<p>AutoDock Vina actually uses a united-atom scoring function, i.e. one that involves only the heavy atoms. Therefore, the positions of the hydrogens in the output are arbitrary. The hydrogens in the input file are used to decide which atoms can be hydrogen bond donors or acceptors though, so the correct protonation of the input structures is still important.</p>
<ul class="simple">
<li><p><strong>What does “exhaustiveness” really control, under the hood?</strong></p></li>
</ul>
<p>In the current implementation, the docking calculation consists of a number of independent runs, starting from random conformations. Each of these runs consists of a number of sequential steps. Each step involves a random perturbation of the conformation followed by a local optimization (using the Broyden-Fletcher-Goldfarb-Shanno algorithm) and a selection in which the step is either accepted or not. Each local optimization involves many evaluations of the scoring function as well as its derivatives in the position-orientation-torsions coordinates. The number of evaluations in a local optimization is guided by convergence and other criteria. The number of steps in a run is determined heuristically, depending on the size and flexibility of the ligand and the flexible side chains. However, the number of runs is set by the exhaustiveness parameter. Since the individual runs are executed in parallel, where appropriate, exhaustiveness also limits the parallelism. Unlike in AutoDock 4, in AutoDock Vina, each run can produce several results: promising intermediate results are remembered. These are merged, refined, clustered and sorted automatically to produce the final result.</p>
<ul class="simple">
<li><p><strong>Why do I not get the correct bound conformation?</strong></p></li>
</ul>
<p>It can be any of a number of things:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If you are coming from AutoDock 4, a very common mistake is to specify the search space in “points” (0.375 Angstrom), instead of Angstroms.</p></li>
<li><p>Your ligand or receptor might not have been correctly protonated.</p></li>
<li><p>Bad luck (the search algorithm could have found the correct conformation with good probability, but was simply unlucky). Try again with a different seed.</p></li>
<li><p>The minimum of the scoring function correponds to the correct conformation, but the search algorithm has trouble finding it. In this case, higher exhaustiveness or smaller search space should help.</p></li>
<li><p>The minimum of the scoring function simply is not where the correct conformation is. Trying over and over again will not help, but may occasionally give the right answer if two wrongs (inexact search and scoring) make a right. Docking is an approximate approach.</p></li>
<li><p>Related to the above, the culprit may also be the quality of the X-ray or NMR receptor structure.</p></li>
<li><p>If you are not doing redocking, i.e. using the correct induced fit shape of the receptor, perhaps the induced fit effects are large enough to affect the outcome of the docking experiment.</p></li>
<li><p>The rings can only be rigid during docking. Perhaps they have the wrong conformation, affecting the outcome.</p></li>
<li><p>You are using a 2D (flat) ligand as input.</p></li>
<li><p>The actual bound conformation of the ligand may occasionally be different from what the X-ray or NMR structure shows.</p></li>
<li><p>Other problems</p></li>
</ol>
</div></blockquote>
<ul class="simple">
<li><p><strong>How can I tweak the scoring function?</strong></p></li>
</ul>
<p>You can change the weights easily, by specifying them in the configuration file, or in the command line. For example</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">vina</span> <span class="pre">--weight_hydrogen</span> <span class="pre">-1.2</span> <span class="pre">...</span></code></p>
</div></blockquote>
<p>doubles the strenth of all hydrogen bonds.</p>
<ul class="simple">
<li><p><strong>Functionality that would allow the users to create new atom and pseudo-atom types, and specify their own interaction functions is planned for the future.</strong></p></li>
</ul>
<p>This should make it easier to adapt the scoring function to specific targets, model covalent docking and macro-cycle flexibility, experiment with new scoring functions, and, using pseudo-atoms, create directional interaction models.</p>
<p>Stay tuned to the AutoDock mailing list, if you wish to be notified of any beta-test releases.</p>
<ul class="simple">
<li><p><strong>Why don’t I get as many binding modes as I specify with “–num_modes”?</strong></p></li>
</ul>
<p>This option specifies the maximum number of binding modes to output. The docking algorithm may find fewer “interesting” binding modes internally. The number of binding modes in the output is also limited by the “energy_range”, which you may want to increase.</p>
<ul class="simple">
<li><p><strong>Why don’t the results change when I change the partial charges?</strong></p></li>
</ul>
<p>AutoDock Vina ignores the user-supplied partial charges. It has its own way of dealing with the electrostatic interactions through the hydrophobic and the hydrogen bonding terms. See the original publication [*] for details of the scoring function.</p>
<ul class="simple">
<li><p><strong>I changed something, and now the docking results are different. Why?</strong></p></li>
</ul>
<p>Firstly, had you not changed anything, some results could have been different anyway, due to the non-deterministic nature of the search algorithm. Exact reproducibility can be assured by supplying the same random seed to both calculations, but only if all other inputs and parameters are the same as well. Even minor changes to the input can have an effect similar to a new random seed. What does make sense discussing are the statistical properties of the calculations: e.g. “with the new protonation state, Vina is much less likely to find the correct docked conformation”.</p>
<ul class="simple">
<li><p><strong>How do I use flexible side chains?</strong></p></li>
</ul>
<p>You split the receptor into two parts: rigid and flexible, with the latter represented somewhat similarly to how the ligand is represented. See the section “Flexible Receptor PDBQT Files” of the AutoDock4.2 User Guide (page 14) for how to do this in AutoDock Tools. Then, you can issue this command: vina –config conf –receptor rigid.pdbqt –flex side_chains.pdbqt –ligand ligand.pdbqt. Also see this write-up on this subject.</p>
<ul class="simple">
<li><p><strong>How do I do virtual screening?</strong></p></li>
</ul>
<p>Please see the relevant section of the manual. Please note that a variety of docking management applications exist to assist you in this task.</p>
<ul class="simple">
<li><p><strong>I have ideas for new features and other suggestions.</strong></p></li>
</ul>
<p>For proposed new features, we like there to be a wide consensus, resulting from a public discussion, regarding their necessity. Please consider starting or joining a discussion on the AutoDock mailing list.</p>
<ul class="simple">
<li><p><strong>Will you answer my questions about Vina if I email or call you?</strong></p></li>
</ul>
<p>No. Vina is community-supported. There is no obligation on the authors to help others with their projects. Please see this page for how to get help.</p>
</section>
<span id="document-citations"></span><section id="citations">
<h3>Citations<a class="headerlink" href="#citations" title="Permalink to this headline"></a></h3>
<section id="autodock-vina">
<h4>AutoDock Vina<a class="headerlink" href="#autodock-vina" title="Permalink to this headline"></a></h4>
<p>AutoDock Vina is a scientific software that is described in academics publications. Please cite these papers when you used AutoDock Vina in your work:</p>
<ul class="simple">
<li><p>Eberhardt, J., Santos-Martins, D.,  Tillack, A.F., Forli, S. (2021). AutoDock Vina 1.2.0: New Docking Methods, Expanded Force Field, and Python Bindings. Journal of Chemical Information and Modeling.</p></li>
<li><p>Trott, O., &amp; Olson, A. J. (2010). AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading. Journal of computational chemistry, 31(2), 455-461.</p></li>
</ul>
</section>
<section id="related-publications">
<h4>Related publications<a class="headerlink" href="#related-publications" title="Permalink to this headline"></a></h4>
<ul class="simple">
<li><p>Santos-Martins, D., Eberhardt, J., Bianco, G., Solis-Vasquez, L., Ambrosio, F. A., Koch, A., &amp; Forli, S. (2019). D3R Grand Challenge 4: prospective pose prediction of BACE1 ligands with AutoDock-GPU. Journal of Computer-Aided Molecular Design, 33(12), 1071-1081.</p></li>
<li><p>Forli, S., Huey, R., Pique, M. E., Sanner, M. F., Goodsell, D. S., &amp; Olson, A. J. (2016). Computational protein–ligand docking and virtual drug screening with the AutoDock suite. Nature protocols, 11(5), 905-919.</p></li>
<li><p>Santos-Martins, D., Forli, S., Ramos, M. J., &amp; Olson, A. J. (2014). AutoDock4Zn: an improved AutoDock force field for small-molecule docking to zinc metalloproteins. Journal of chemical information and modeling, 54(8), 2371-2379.</p></li>
<li><p>Forli, S., &amp; Olson, A. J. (2012). A force field with discrete displaceable waters and desolvation entropy for hydrated ligand docking. Journal of medicinal chemistry, 55(2), 623-638.</p></li>
<li><p>Forli, S., &amp; Botta, M. (2007). Lennard-Jones potential and dummy atom settings to overcome the AUTODOCK limitation in treating flexible ring systems. Journal of chemical information and modeling, 47(4), 1481-1492.</p></li>
</ul>
</section>
</section>
<span id="document-changes"></span><section id="changes">
<h3>Changes<a class="headerlink" href="#changes" title="Permalink to this headline"></a></h3>
<section id="id1">
<h4>1.2.0<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Refactoring of the Vina code to be able to be used as a library</p></li>
<li><p>Can load external maps</p></li>
<li><p>Support of simultaneous docking of multiple ligands and batch mode for virtual screening</p></li>
<li><p>Support of macrocycle molecules</p></li>
<li><p>Addition of the hydrated docking protocol</p></li>
<li><p>Added AutoDock4 and Vinardo forcefields</p></li>
<li><p>Added Python bindings for Python 3</p></li>
</ul>
</div></blockquote>
</section>
<section id="id2">
<h4>1.1.2<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Bug fix: the affinities reported with flexible side chains were
sometimes incorrect. (This problem had no effect on the predicted
binding modes or their relative ranking, or on rigid receptor
docking)</p></li>
<li><p>Bug fix: the individual term values, before weighting, reported
only with “score_only”, were often wrong. (This problem
had no effect on the predicted binding modes or affinities)</p></li>
<li><p>The predicted binding modes are made less redundant by requiring
that no two reported modes differ by less than 1 Angstrom RMSD(U.B.),
counting all movable heavy atoms, including those in the side chains.
Previously, Vina avoided this kind of redundancy during the actual
docking, but made no such guarantee w.r.t. the output because
of the subsequent refinement stage that could move different binding
modes closer</p></li>
<li><p>Bug fix: in some very unusual cases, numerical rounding errors would
accumulate, leading, internally, to a distorted ligand structure.
The self-checks in Vina would catch this and make the program quit
rather than write invalid output. This numerical error accumulation
is believed to have been fixed in this update</p></li>
<li><p>A warning is added when the search space is greater than
27000 Angstrom^3 in volume, as confusing Angstroms with
“grid points” is a frequent user error</p></li>
</ul>
</div></blockquote>
</section>
<section id="id3">
<h4>1.1.1<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Source code released</p></li>
<li><p>License changed to Apache</p></li>
<li><p>Extensive code clean-up that however should not have any effect
on the end users</p></li>
<li><p>Unix binary packages changed to simple archives</p></li>
</ul>
</div></blockquote>
</section>
<section id="id4">
<h4>1.1.0<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul>
<li><p>Added “advanced options” intended to be primarily used by people
interested in methods development.</p>
<p>These should allow scoring without minimization; performing
local optimization only; randomizing the input with no search
(this is useful for testing docking software); changing the
weights from their default values; displaying the individual
contributions to the intermolecular score, before weighting
(these are shown with “–score_only”)</p>
</li>
</ul>
</div></blockquote>
</section>
<section id="id5">
<h4>1.0.3<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Mac OS X 10.6 (Snow Leopard) support added</p></li>
<li><p>A bug related to (very rarely) not finding any modes when the
“num_modes” setting is low (e.g. 1) has been fixed.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id6">
<h4>1.0.2<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Fixed a bug that excluded conformations in which only a hydrogen atom was
outside the search space.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id7">
<h4>1.0.1<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>When the search space is too small or misplaced, so that the ligand and
flexible side chain conformations can not be found within it, Vina will
no longer produce any “binding modes” and print a warning instead</p></li>
<li><p>Minor improvements in user-friendliness of the error messages.</p></li>
</ul>
</div></blockquote>
</section>
<section id="id8">
<h4>1.0<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Support for earlier versions of Linux added, such as Debian 4.0</p></li>
<li><p>Friendlier and more specific error messages for PDBQT syntax errors</p></li>
<li><p>“all” parameter is now called “out” and is always enabled. Individual
binding modes are no longer written separately. If needed, the multimodel
output can be split into individual models using a separate program
called “vina_split”, included in the distribution</p></li>
<li><p>The default “num_modes” value changed to 9.</p></li>
</ul>
</div></blockquote>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-docking_requirements"></span><section id="software-requirements">
<span id="docking-requirements"></span><h3>Software requirements<a class="headerlink" href="#software-requirements" title="Permalink to this headline"></a></h3>
<p>For those tutorials, the ADFR software suite, providing a number of software tools for automated docking and peripheral tasks, and the Python package Raccoon-lite, for preparing macrocycle for example, are necessary.</p>
<section id="adfr-software-suite">
<h4>ADFR software suite<a class="headerlink" href="#adfr-software-suite" title="Permalink to this headline"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>macOS users please note that ADFR software suite is NOT working under Catalina (10.15). We will send email to the mailing list if and when ADFR software suite or an alternative will be available for this version of macOS. If you already are using Catalina, we recommend install VirtualBox and running ADFR software suite inside the virtual box.</p>
</div>
<p>The ADFR software suite was developed in the Sanner lab at the <a class="reference external" href="https://ccsb.scripps.edu">Center for Computational Structural Biology (CCSB)</a> formerly known as the Molecular Graphics Laboratory (MGL) of The Scripps Research Institute for visualization and analysis of molecular structures. You can find more information about the ADFR software suite installation process here: <a class="reference external" href="https://ccsb.scripps.edu/adfr/downloads/">https://ccsb.scripps.edu/adfr/downloads</a>. The current version contains the following tools for docking:</p>
<blockquote>
<div><ul class="simple">
<li><p>ADFR v1.2 and associate scripts</p></li>
<li><p>AGFR v1.2</p></li>
<li><p>AutoSite v1.0 and v1.1</p></li>
<li><p>ADCP v1.0</p></li>
<li><p>AutoGrid4.2</p></li>
<li><p>prepare_ligand</p></li>
<li><p>prepare_receptor</p></li>
</ul>
</div></blockquote>
<p>Moreover, the ADFR software suite provides a number of software tools for automated docking and peripheral tasks. These tools are implemented using the Python, C++ and C programming languages and a re-usable component philosophy. To avoid Python packages mismatches we opted to shift ADFR suite with a self-contain Python interpreter that is isolated from the default Python interpreter installed on your computer (except for Windows installations). Details about the implementation and packages provided by the ADFR software suite can be found here: <a class="reference external" href="https://ccsb.scripps.edu/adfr/implementation/">https://ccsb.scripps.edu/adfr/implementation</a></p>
<p><strong>Citations</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Zhang, Y., Forli, S., Omelchenko, A., &amp; Sanner, M. F. (2019). AutoGridFR: Improvements on AutoDock Affinity Maps and Associated Software Tools. Journal of Computational Chemistry, 40(32), 2882-2886.</p></li>
<li><p>Zhang, Y., &amp; Sanner, M. F. (2019). AutoDock CrankPep: combining folding and docking to predict protein–peptide complexes. Bioinformatics, 35(24), 5121-5127.</p></li>
<li><p>Ravindranath, P. A., &amp; Sanner, M. F. (2016). AutoSite: an automated approach for pseudo-ligands prediction—from ligand-binding sites identification to predicting key ligand atoms. Bioinformatics, 32(20), 3142-3149.</p></li>
<li><p>Ravindranath, P. A., Forli, S., Goodsell, D. S., Olson, A. J., &amp; Sanner, M. F. (2015). AutoDockFR: advances in protein-ligand docking with explicitly specified binding site flexibility. PLoS computational biology, 11(12), e1004586.</p></li>
<li><p>Zhao, Y., Stoffler, D., &amp; Sanner, M. (2006). Hierarchical and multi-resolution representation of protein flexibility. Bioinformatics, 22(22), 2768-2774.</p></li>
</ul>
</div></blockquote>
</section>
<section id="meeko">
<h4>Meeko<a class="headerlink" href="#meeko" title="Permalink to this headline"></a></h4>
<p>The Python package <code class="docutils literal notranslate"><span class="pre">meeko</span></code> is a new type of package developped in the Forli lab also at the <a class="reference external" href="https://ccsb.scripps.edu">Center for Computational Structural Biology (CCSB)</a>.  It provides tools covering other docking aspects not handled by the ADFR software suite. This package provides addtionnal tools for the following docking protocols:</p>
<blockquote>
<div><ul class="simple">
<li><p>Hydrated docking</p></li>
<li><p>Macrocycles</p></li>
</ul>
</div></blockquote>
<p><strong>Meeko installation using pip</strong>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">pip</span></code>, it’s good pratice to use a virtual environment and also the easiest solution. An example with the <a class="reference external" href="https://docs.conda.io/en/latest/">Conda package manager</a> is available further down.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>OpenBabel executable and library must be installed first, see <a class="reference external" href="https://open-babel.readthedocs.io/en/latest/Installation/install.html#install-binaries">installation instruction</a>.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install -U numpy openbabel meeko
</pre></div>
</div>
<p>If the installation was successful, you should now be able to access to the following command from your terminal by typing:</p>
<blockquote>
<div><ul class="simple">
<li><p>mk_prepare_ligand.py</p></li>
</ul>
</div></blockquote>
<p><strong>Meeko installation in a Conda environment</strong>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See instructions in <a class="reference internal" href="index.html#installation"><span class="std std-ref">Installation</span></a> on how to setup and create an dedicated <code class="docutils literal notranslate"><span class="pre">Conda</span></code> environment.</p>
</div>
<p>Type the following command to install <code class="docutils literal notranslate"><span class="pre">NumPy</span></code>, <code class="docutils literal notranslate"><span class="pre">OpenBabel</span></code> and <code class="docutils literal notranslate"><span class="pre">meeko</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ conda activate vina
$ conda install -c conda-forge numpy openbabel
$ pip install meeko
</pre></div>
</div>
</section>
</section>
<span id="document-docking_basic"></span><section id="basic-docking">
<span id="id1"></span><h3>Basic docking<a class="headerlink" href="#basic-docking" title="Permalink to this headline"></a></h3>
<p>Let’s start with our first example of docking, where the typical usage pattern would be to dock a single molecule into a rigid receptor. In this example we will dock the approved anticancer drug <a class="reference external" href="https://en.wikipedia.org/wiki/Imatinib">imatinib</a> (Gleevec; PDB entry <a class="reference external" href="https://www.rcsb.org/structure/1IEP">1iep</a>) in the structure of c-Abl using AutoDock Vina. The target for this protocol is the kinase domain of the proto-oncogene tyrosine protein kinase c-Abl. The protein is an important target for cancer chemotherapy—in particular, the treatment of chronic myelogenous leukemia.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires a certain degree of familiarity with the command-line interface. Also, we assume that you installed the ADFR software suite as well as the meeko Python package.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The materials present is this tutorial can be also found here: <a class="reference external" href="https://www.nature.com/articles/nprot.2016.051">https://www.nature.com/articles/nprot.2016.051</a>. If you are using this tutorial for your works, you can cite the following paper:</p>
<ul class="simple">
<li><p>Forli, S., Huey, R., Pique, M. E., Sanner, M. F., Goodsell, D. S., &amp; Olson, A. J. (2016). Computational protein–ligand docking and virtual drug screening with the AutoDock suite. Nature protocols, 11(5), 905-919.</p></li>
</ul>
</div>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/basic_docking/data</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/basic_docking">GitHub</a>). If you ever feel lost, you can always take a look at the solution here: <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/basic_docking/solution</span></code>. All the Python scripts used here (except for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> and <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>) are located in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/autodock_scripts</span></code> directory, alternatively you can also find them here on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">GitHub</a>.</p>
</section>
<section id="preparing-the-receptor">
<h4>1. Preparing the receptor<a class="headerlink" href="#preparing-the-receptor" title="Permalink to this headline"></a></h4>
<p>During this step, we will create a PDBQT file of our receptor containing only the polar hydrogen atoms as well as partial charges. For this step, we will use the <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> command tool from the ADFR Suite. As a prerequisite, a receptor coordinate file must contain all hydrogen atoms. If hydrogen atoms are absent in the protein structure file, you can add the <code class="docutils literal notranslate"><span class="pre">-A</span> <span class="pre">&quot;hydrogens&quot;</span></code> flag. Many tools exist to add missing hydrogen atoms to a protein, one popular choice would be to use <a class="reference external" href="http://kinemage.biochem.duke.edu/software/reduce.php">REDUCE</a>. If you are using experimental structures (for instance, from the <a class="reference external" href="https://www.rcsb.org">Protein Data Bank</a>), use a text editor to remove waters, ligands, cofactors, ions deemed unnecessary for the docking. This file contains the receptor coordinates taken from PDB entry <a class="reference external" href="https://www.rcsb.org/structure/1IEP">1iep</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ prepare_receptor -r 1iep_receptorH.pdb -o 1iep_receptor.pdbqt
</pre></div>
</div>
<p>Other options are available for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> by typing <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span> <span class="pre">-h</span></code>. If you are not sure about this step, the output PDBQT file <code class="docutils literal notranslate"><span class="pre">1iep_receptor.pdbqt</span></code> is available in <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="preparing-the-ligand">
<h4>2. Preparing the ligand<a class="headerlink" href="#preparing-the-ligand" title="Permalink to this headline"></a></h4>
<p>This step is very similar to the previous step. We will also create a PDBQT file from a ligand molecule file (in MOL/MOL2 or SDF format) using the <code class="docutils literal notranslate"><span class="pre">Meeko</span></code> python package (see installation instruction here: <a class="reference internal" href="index.html#docking-requirements"><span class="std std-ref">Software requirements</span></a>). For convenience, the file <code class="docutils literal notranslate"><span class="pre">1iep_ligand.sdf</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). But you can obtain it directly from the <a class="reference external" href="https://www.rcsb.org">PDB</a> here: <a class="reference external" href="https://www.rcsb.org/structure/1IEP">1iep</a> (see <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">instance</span> <span class="pre">Coordinates</span></code> link for the STI molecule). Since the ligand file does not include the hydrogen atoms, we are going to automatically add them.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We strongly advice you against using PDB format for preparing small molecules, since it does not contain information about bond connections. Please don’t forget to always check the protonation state of your molecules before docking. Your success can sometimes hang by just an hydrogen atom. ;-)</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mk_prepare_ligand.py -i 1iep_ligand.sdf -o 1iep_ligand.pdbqt
</pre></div>
</div>
<p>Other options are available for <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code> by typing <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span> <span class="pre">--help</span></code>. If you are not sure about this step, the output PDBQT file <code class="docutils literal notranslate"><span class="pre">1iep_ligand.pdbqt</span></code> is available in <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="optional-generating-affinity-maps-for-autodock-ff">
<h4>3. (Optional) Generating affinity maps for AutoDock FF<a class="headerlink" href="#optional-generating-affinity-maps-for-autodock-ff" title="Permalink to this headline"></a></h4>
<p>Now, we have to define the grid space for the docking, typically, a 3D box around a the potential binding site of a receptor. During this step, we will create the input file for AutoGrid4, which will create an affinity map file for each atom types. The grid parameter file specifies an AutoGrid4 calculation, including the size and location of the grid, the atom types that will be used, the coordinate file for the rigid receptor, and other parameters for calculation of the grids.</p>
<p>To prepare the gpf file for AutoGrid4, you can use the <code class="docutils literal notranslate"><span class="pre">prepare_gpf.py</span></code> command line tool.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pythonsh &lt;script_directory&gt;/prepare_gpf.py -l 1iep_ligand.pdbqt -r 1iep_receptor.pdbqt -y
</pre></div>
</div>
<p>The option <code class="docutils literal notranslate"><span class="pre">-y</span></code> specifies that we want to center automatically the grid around the ligand. For more information about <code class="docutils literal notranslate"><span class="pre">prepare_gpf.py</span></code>, type <code class="docutils literal notranslate"><span class="pre">pythonsh</span> <span class="pre">prepare_gpf.py</span> <span class="pre">-h</span></code>. At the end you should obtain the following GPF file <code class="docutils literal notranslate"><span class="pre">1iep_receptor.gpf</span></code> containing those lines:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Content of the grid parameter file (<strong>1iep_receptor.gpf</strong>) for the receptor c-Abl (<strong>1iep_receptor.pdbqt</strong>)</span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npts 54 54 54                        # num.grid points in xyz</span>
<span class="go">gridfld 1iep_receptor.maps.fld       # grid_data_file</span>
<span class="go">spacing 0.375                        # spacing(A)</span>
<span class="go">receptor_types A C OA N SA HD        # receptor atom types</span>
<span class="go">ligand_types A C NA OA N HD          # ligand atom types</span>
<span class="go">receptor 1iep_receptor.pdbqt         # macromolecule</span>
<span class="go">gridcenter 15.190 53.903 16.917      # xyz-coordinates or auto</span>
<span class="go">smooth 0.5                           # store minimum energy w/in rad(A)</span>
<span class="go">map 1iep_receptor.A.map              # atom-specific affinity map</span>
<span class="go">map 1iep_receptor.C.map              # atom-specific affinity map</span>
<span class="go">map 1iep_receptor.NA.map             # atom-specific affinity map</span>
<span class="go">map 1iep_receptor.OA.map             # atom-specific affinity map</span>
<span class="go">map 1iep_receptor.N.map              # atom-specific affinity map</span>
<span class="go">map 1iep_receptor.HD.map             # atom-specific affinity map</span>
<span class="go">elecmap 1iep_receptor.e.map          # electrostatic potential map</span>
<span class="go">dsolvmap 1iep_receptor.d.map         # desolvation potential map</span>
<span class="go">dielectric -0.1465                   # &lt;0, AD4 distance-dep.diel;&gt;0, constant</span>
</pre></div>
</div>
</div>
<p>After creating the GPF file, and now we can use the <code class="docutils literal notranslate"><span class="pre">autogrid4</span></code> command to generate the different map files that will be used for the molecular docking:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ autogrid4 -p 1iep.gpf -l 1iep.glg
</pre></div>
</div>
<p>From this command you should have generated the following files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1iep_receptor.maps.fld       # grid data file</span>
<span class="go">1iep_receptor.*.map          # affinity maps for A, C, HD, H, NA, N, OA atom types</span>
<span class="go">1iep_receptor.d.map          # desolvation map</span>
<span class="go">1iep_receptor.e.map          # electrostatic map</span>
</pre></div>
</div>
</section>
<section id="running-autodock-vina">
<h4>4. Running AutoDock Vina<a class="headerlink" href="#running-autodock-vina" title="Permalink to this headline"></a></h4>
<p>The imatinib ligand used in this protocol is challenging, and Vina will occasionally not find the correct pose with the default parameters. Vina provides a parameter called <code class="docutils literal notranslate"><span class="pre">exhaustiveness</span></code> to change the amount of computational effort used during a docking experiment. The default exhaustiveness value is <code class="docutils literal notranslate"><span class="pre">8</span></code>; increasing this to <code class="docutils literal notranslate"><span class="pre">32</span></code> will give a more consistent docking result. At this point of the tutorial, you have the choice to decide to run the molecular docking using either the <code class="docutils literal notranslate"><span class="pre">AutoDock</span></code> forcefield (requires affinity maps, see previous step) or using the <code class="docutils literal notranslate"><span class="pre">Vina</span></code> forcefield (no need for affinity maps).</p>
<section id="a-using-autodock4-forcefield">
<h5>4.a. Using AutoDock4 forcefield<a class="headerlink" href="#a-using-autodock4-forcefield" title="Permalink to this headline"></a></h5>
<p>When using the AutoDock4 forcefield, you only need to provide the affinity maps and the ligand, while specifying that the forcefield used will be AutoDock4 using the option <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">ad4</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina  --ligand 1iep_ligand.pdbqt --maps 1iep_receptor --scoring ad4 <span class="se">\</span>
        --exhaustiveness <span class="m">32</span> --out 1iep_ligand_ad4_out.pdbqt
</pre></div>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">1iep_ligand_ad4_out.pdbqt</span></code> contaning all the poses found during the molecular docking and also present docking information to the terminal window.</p>
</section>
<section id="b-using-vina-forcefield">
<h5>4.b. Using Vina forcefield<a class="headerlink" href="#b-using-vina-forcefield" title="Permalink to this headline"></a></h5>
<p>Contrary to AutoDock4, you don’t need to precalculate the affinity grid maps with <code class="docutils literal notranslate"><span class="pre">autogrid4</span></code> when using the Vina forcefield. AutoDock Vina computes those maps internally before the docking. However, you still need to specify the center and dimensions (in Angstrom) of the grid space, as well as the receptor. Here, instead of specifying each parameters for the grid box using the arguments <code class="docutils literal notranslate"><span class="pre">--center_x,</span> <span class="pre">--center_y,</span> <span class="pre">--center_z</span></code> and <code class="docutils literal notranslate"><span class="pre">--size_x,</span> <span class="pre">--size_y,</span> <span class="pre">--size_z</span></code>, we will store all those informations in a text file <code class="docutils literal notranslate"><span class="pre">1iep_receptor_vina_box.txt</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Content of the config file (<strong>1iep_receptor_vina_box.txt</strong>) for AutoDock Vina</span><a class="headerlink" href="#id7" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">center_x = 15.190</span>
<span class="go">center_y = 53.903</span>
<span class="go">center_z = 16.917</span>
<span class="go">size_x = 20.0</span>
<span class="go">size_y = 20.0</span>
<span class="go">size_z = 20.0</span>
</pre></div>
</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --receptor 1iep_receptor.pdbqt --ligand 1iep_ligand.pdbqt <span class="se">\</span>
       --config 1iep_receptor_vina_box.txt <span class="se">\</span>
       --exhaustiveness<span class="o">=</span><span class="m">32</span> --out 1iep_ligand_vina_out.pdbqt
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, you can use the Vinardo forcefield by adding the <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">vinardo</span></code> option.</p>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">1iep_ligand_vina_out.pdbqt</span></code>.</p>
</section>
</section>
<section id="results">
<h4>5. Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h4>
<p>With <code class="docutils literal notranslate"><span class="pre">exhaustiveness</span></code> set to <code class="docutils literal notranslate"><span class="pre">32</span></code>, Vina will most often give a single docked pose with this energy. With the lower default exhaustiveness, several poses flipped end to end, with less favorable energy, may be reported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please don’t forget that energy scores giving by the AutoDock and Vina forcefield are not comparable between each other.</p>
</div>
<section id="a-using-autodock-forcefield">
<h5>5.a. Using AutoDock forcefield<a class="headerlink" href="#a-using-autodock-forcefield" title="Permalink to this headline"></a></h5>
<p>The predicted free energy of binding should be about <code class="docutils literal notranslate"><span class="pre">-14</span> <span class="pre">kcal/mol</span></code> for poses that are similar to the crystallographic pose.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : ad4</span>
<span class="go">Ligand: 1iep_ligand.pdbqt</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Reading AD4.2 maps ... done.</span>
<span class="go">Performing docking (random seed: -556654859) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -14.62          0          0</span>
<span class="go">   2       -13.13      1.051      1.529</span>
<span class="go">   3       -12.26      1.442      2.158</span>
<span class="go">   4       -11.91      3.646       11.5</span>
<span class="go">   5       -11.89      3.859      11.99</span>
<span class="go">   6       -11.47      1.978      13.56</span>
<span class="go">   7       -11.33      1.727      2.585</span>
<span class="go">   8       -10.85      3.619      5.759</span>
<span class="go">   9       -10.23      7.057       12.7</span>
</pre></div>
</div>
</section>
<section id="id5">
<h5>5.b. Using Vina forcefield<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h5>
<p>Using the vina forcefield, you should obtain a similar output from Vina with the best score around <code class="docutils literal notranslate"><span class="pre">-13</span> <span class="pre">kcal/mol</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : vina</span>
<span class="go">Rigid receptor: 1iep_receptor.pdbqt</span>
<span class="go">Ligand: 1iep_ligand.pdbqt</span>
<span class="go">Center: X 15.19 Y 53.903 Z 16.917</span>
<span class="go">Size: X 20 Y 20 Z 20</span>
<span class="go">Grid space: 0.375</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Computing Vina grid ... done.</span>
<span class="go">Performing docking (random seed: -131415392) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -12.92          0          0</span>
<span class="go">   2       -10.97      3.012      12.42</span>
<span class="go">   3       -10.79      3.713      12.19</span>
<span class="go">   4       -10.69      3.913      12.36</span>
<span class="go">   5       -10.32      2.538      12.64</span>
<span class="go">   6       -9.464      2.916      12.53</span>
<span class="go">   7       -9.204       1.35      2.025</span>
<span class="go">   8       -9.137      1.596      2.674</span>
<span class="go">   9       -8.637      3.969      12.69</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-docking_flexible"></span><section id="flexible-docking">
<span id="id1"></span><h3>Flexible docking<a class="headerlink" href="#flexible-docking" title="Permalink to this headline"></a></h3>
<p>The lack of receptor flexibility is arguably the greatest limitation in these types of docking methods. However, AutoDock Vina allows some limited flexibility of selected receptor side chains. In this tutorial, we will describe the cross-docking of the <a class="reference external" href="https://en.wikipedia.org/wiki/Imatinib">imatinib molecule</a> to c-Abl in PDB entry <a class="reference external" href="https://www.rcsb.org/structure/1FPU">1fpu</a>, treating Thr315 as flexible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires a certain degree of familiarity with the command-line interface. Also, we assume that you installed the ADFR software suite as well as the meeko Python package.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The materials present is this tutorial can be also found here: <a class="reference external" href="https://www.nature.com/articles/nprot.2016.051">https://www.nature.com/articles/nprot.2016.051</a>. If you are using this tutorial for your works, you can cite the following paper:</p>
<ul class="simple">
<li><p>Forli, S., Huey, R., Pique, M. E., Sanner, M. F., Goodsell, D. S., &amp; Olson, A. J. (2016). Computational protein–ligand docking and virtual drug screening with the AutoDock suite. Nature protocols, 11(5), 905-919.</p></li>
</ul>
</div>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/flexible_docking/data</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/flexible_docking">GitHub</a>). If you ever feel lost, you can always take a look at the solution here: <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/flexible_docking/solution</span></code>. All the Python scripts used here (except for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> and <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>) are located in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/autodock_scripts</span></code> directory, alternatively you can also find them here on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">GitHub</a>.</p>
</section>
<section id="preparing-the-flexible-receptor">
<h4>1. Preparing the flexible receptor<a class="headerlink" href="#preparing-the-flexible-receptor" title="Permalink to this headline"></a></h4>
<p>During this step, we are going to split the receptor coordinates into two PDBQT files: one for the rigid portion and one for the flexible side chains. As with the <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a> tutorial, the method requires a receptor coordinate file that includes all hydrogen atoms. The file <code class="docutils literal notranslate"><span class="pre">1fpu_receptorH.pdb</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">&lt;autodock-vina_directory&gt;/example/flexible_docking/data</span></code> directory). It contains the receptor coordinates taken from PDB entry <code class="docutils literal notranslate"><span class="pre">1fpu</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ prepare_receptor -r 1fpu_receptorH.pdb -o 1fpu_receptor.pdbqt
$ pythonsh &lt;script_directory&gt;/prepare_flexreceptor.py -r 1fpu_receptor.pdbqt -s THR315
</pre></div>
</div>
<p>Other options are available for <code class="docutils literal notranslate"><span class="pre">prepare_flexreceptor.py</span></code> with the <code class="docutils literal notranslate"><span class="pre">-h</span></code> option. This will create two different files, one containing only the rigid part of the protein, and the other one containing Thr315 as flexible residue:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1fpu_receptor_rigid.pdbqt           # rigid part</span>
<span class="go">1fpu_receptor_flex.pdbqt            # flexible sidechain of Thr315</span>
</pre></div>
</div>
<p>If you are not sure about this step, the output PDBQT files <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_rigid.pdbqt</span></code> and <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_flex.pdbqt</span></code> are available in <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="prepare-ligand">
<h4>2. Prepare ligand<a class="headerlink" href="#prepare-ligand" title="Permalink to this headline"></a></h4>
<p>For the molecular docking with flexible sidechains, we will use the ligand file <code class="docutils literal notranslate"><span class="pre">1iep_ligand.pdbqt</span></code> from the previous tutorial <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a>.</p>
</section>
<section id="optional-generating-affinity-maps-for-autodock-ff">
<h4>3. (Optional) Generating affinity maps for AutoDock FF<a class="headerlink" href="#optional-generating-affinity-maps-for-autodock-ff" title="Permalink to this headline"></a></h4>
<p>As well as for the docking with a fully rigid receptor, we need to generate a GPF file to precalculate the affinity map for each atom types. However, instead of using the full receptor, affinity maps will be calculated only for the rigid part of the receptor (<code class="docutils literal notranslate"><span class="pre">1fpu_receptor_rigid.pdbqt</span></code>).</p>
<p>To prepare the GPF file for the rigid part of the receptor:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pythonsh &lt;script_directory&gt;/prepare_gpf.py -l 1iep_ligand.pdbqt -r 1fpu_receptor_rigid.pdbqt -y
</pre></div>
</div>
<p>Luckily for us, the structure <code class="docutils literal notranslate"><span class="pre">1iep</span></code> and <code class="docutils literal notranslate"><span class="pre">1fpu</span></code> are almost perfectly superposed already, so we can also center the grid around <code class="docutils literal notranslate"><span class="pre">1iep_ligand.pdbqt</span></code>. Otherwise, the center of the grid can be specified using the option <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">gridcenter='X,X,X'</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Content of the grid parameter file (<strong>1fpu_receptor_rigid.gpf</strong>) for the receptor c-Abl (<strong>1fpu_receptor_rigid.pdbqt</strong>)</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npts 54 54 54                        # num.grid points in xyz</span>
<span class="go">gridfld 1fpu_receptor_rigid.maps.fld # grid_data_file</span>
<span class="go">spacing 0.375                        # spacing(A)</span>
<span class="go">receptor_types A C NA OA N SA HD     # receptor atom types</span>
<span class="go">ligand_types A C NA OA N HD          # ligand atom types</span>
<span class="go">receptor 1fpu_receptor_rigid.pdbqt   # macromolecule</span>
<span class="go">gridcenter 15.190 53.903 16.917      # xyz-coordinates or auto</span>
<span class="go">smooth 0.5                           # store minimum energy w/in rad(A)</span>
<span class="go">map 1fpu_receptor_rigid.A.map        # atom-specific affinity map</span>
<span class="go">map 1fpu_receptor_rigid.C.map        # atom-specific affinity map</span>
<span class="go">map 1fpu_receptor_rigid.NA.map       # atom-specific affinity map</span>
<span class="go">map 1fpu_receptor_rigid.OA.map       # atom-specific affinity map</span>
<span class="go">map 1fpu_receptor_rigid.N.map        # atom-specific affinity map</span>
<span class="go">map 1fpu_receptor_rigid.HD.map       # atom-specific affinity map</span>
<span class="go">elecmap 1fpu_receptor_rigid.e.map    # electrostatic potential map</span>
<span class="go">dsolvmap 1fpu_receptor_rigid.d.map   # desolvation potential map</span>
<span class="go">dielectric -0.1465                   # &lt;0, AD4 distance-dep.diel;&gt;0, constant</span>
</pre></div>
</div>
</div>
<p>To execute <code class="docutils literal notranslate"><span class="pre">autogrid4</span></code> using <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_rigid.gpf</span></code>, run the folllowing command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ autogrid4 -p 1fpu_receptor_rigid.gpf -l 1fpu_receptor_rigid.glg
</pre></div>
</div>
<p>You should obtain as well the following files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1fpu_receptor.maps.fld       # grid data file</span>
<span class="go">1fpu_receptor.*.map          # affinity maps for A, C, HD, NA, N, OA atom types</span>
<span class="go">1fpu_receptor.d.map          # desolvation map</span>
<span class="go">1fpu_receptor.e.map          # electrostatic map</span>
</pre></div>
</div>
</section>
<section id="running-autodock-vina">
<h4>4. Running AutoDock Vina<a class="headerlink" href="#running-autodock-vina" title="Permalink to this headline"></a></h4>
<section id="a-using-autodock4-forcefield">
<h5>4.a. Using AutoDock4 forcefield<a class="headerlink" href="#a-using-autodock4-forcefield" title="Permalink to this headline"></a></h5>
<p>While using the AutoDock4 forcefield, only the flex part of the receptor is necessary, as well as the affinity maps. Once the receptor (flex part <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_flex.pdbqt</span></code>), ligand <code class="docutils literal notranslate"><span class="pre">1iep_ligand.pdbqt</span></code> and maps <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_rigid</span></code> were prepared, you can perform the flexible side-chain docking by simply running the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --flex 1fpu_receptor_flex.pdbqt --ligand 1iep_ligand.pdbqt <span class="se">\</span>
       --maps 1fpu_receptor_rigid --scoring ad4 <span class="se">\</span>
       --exhaustiveness <span class="m">32</span> --out 1fpu_ligand_flex_ad4_out.pdbqt
</pre></div>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">1fpu_ligand_flex_ad4_out.pdbqt</span></code> contaning all the poses found during the molecular docking as well as the Thr315 sidechain conformations, and also present docking information to the terminal window.</p>
</section>
<section id="b-using-vina-forcefield">
<h5>4.b. Using Vina forcefield<a class="headerlink" href="#b-using-vina-forcefield" title="Permalink to this headline"></a></h5>
<p>As well as for the fully rigid molecular docking, you only need to specify the center and dimensions (in Angstrom) of the grid. Here, instead of specifying each parameters for the grid box using the arguments <code class="docutils literal notranslate"><span class="pre">--center_x,</span> <span class="pre">--center_y,</span> <span class="pre">--center_z</span></code> and <code class="docutils literal notranslate"><span class="pre">--size_x,</span> <span class="pre">--size_y,</span> <span class="pre">--size_z</span></code>, we will also store all those informations in a text file <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_rigid_vina_box.txt</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Content of the config file (<strong>1fpu_receptor_rigid_vina_box.txt</strong>) for AutoDock Vina</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">center_x = 15.190</span>
<span class="go">center_y = 53.903</span>
<span class="go">center_z = 16.917</span>
<span class="go">size_x = 20.0</span>
<span class="go">size_y = 20.0</span>
<span class="go">size_z = 20.0</span>
</pre></div>
</div>
</div>
<p>However, when using the Vina forcefield, you will need to specify both the rigid <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_rigid.pdbqt</span></code> (needed to compute internally the affinity maps) and flex part <code class="docutils literal notranslate"><span class="pre">1fpu_receptor_flex.pdbqt</span></code> of the receptor. To perform the same docking experiment but using Vina forcefield run the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --receptor 1fpu_receptor_rigid.pdbqt --flex 1fpu_receptor_flex.pdbqt <span class="se">\</span>
       --ligand 1iep_ligand.pdbqt --config 1fpu_receptor_rigid_vina_box.txt <span class="se">\</span>
       --exhaustiveness <span class="m">32</span> --out 1fpu_ligand_flex_vina_out.pdbqt
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, you can use the Vinardo forcefield by adding the <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">vinardo</span></code> option.</p>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">1fpu_ligand_flex_vina_out.pdbqt</span></code>.</p>
</section>
</section>
<section id="results">
<h4>5. Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please don’t forget that energy scores giving by the AutoDock and Vina forcefield are not comparable between each other.</p>
</div>
<section id="a-using-autodock-forcefield">
<h5>5.a. Using AutoDock forcefield<a class="headerlink" href="#a-using-autodock-forcefield" title="Permalink to this headline"></a></h5>
<p>The predicted free energy of binding should be about <code class="docutils literal notranslate"><span class="pre">-15</span> <span class="pre">kcal/mol</span></code> for poses that are similar to the crystallographic pose.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : ad4</span>
<span class="go">Flex receptor: 1fpu_receptor_flex.pdbqt</span>
<span class="go">Ligand: ../data/1iep_ligand.pdbqt</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Reading AD4.2 maps ... done.</span>
<span class="go">Performing docking (random seed: -1132104431) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -15.41          0          0</span>
<span class="go">   2       -14.95      1.164      1.803</span>
<span class="go">   3       -13.92      1.112      1.744</span>
<span class="go">   4       -13.39      3.975      6.038</span>
<span class="go">   5       -13.08       1.48      2.166</span>
<span class="go">   6       -12.13      3.877      11.74</span>
<span class="go">   7       -12.13      5.806      9.094</span>
<span class="go">   8       -11.89      1.251      1.971</span>
<span class="go">   9       -11.55      2.804      10.81</span>
</pre></div>
</div>
</section>
<section id="id3">
<h5>5.b. Using Vina forcefield<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h5>
<p>Using the vina forcefield, you should obtain a similar output from Vina with the best score around <code class="docutils literal notranslate"><span class="pre">-12</span> <span class="pre">kcal/mol</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : vina</span>
<span class="go">Rigid receptor: 1fpu_receptor_rigid.pdbqt</span>
<span class="go">Flex receptor: 1fpu_receptor_flex.pdbqt</span>
<span class="go">Ligand: ../data/1iep_ligand.pdbqt</span>
<span class="go">Center: X 15.19 Y 53.903 Z 16.917</span>
<span class="go">Size: X 20 Y 20 Z 20</span>
<span class="go">Grid space: 0.375</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Computing Vina grid ... done.</span>
<span class="go">Performing docking (random seed: 1973662971) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -12.17          0          0</span>
<span class="go">   2       -11.41       3.23       12.1</span>
<span class="go">   3       -11.22      1.512      2.137</span>
<span class="go">   4       -11.19       4.07         12</span>
<span class="go">   5       -10.64      3.833      11.99</span>
<span class="go">   6        -10.2      2.537      12.12</span>
<span class="go">   7       -9.547      2.493      12.26</span>
<span class="go">   8       -9.367      2.476      12.41</span>
<span class="go">   9       -9.051      3.809      11.72</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-docking_multiple_ligands"></span><section id="multiple-ligands-docking">
<span id="id1"></span><h3>Multiple ligands docking<a class="headerlink" href="#multiple-ligands-docking" title="Permalink to this headline"></a></h3>
<p>Vina is now able to dock simultaneously multiple ligands. This functionality may find application in fragment based drug design, where small molecules that bind the same target can be grown or combined into larger compounds with potentially better affinity.</p>
<p>The protein PDE in complex with two inhibitors (pdb id: <a class="reference external" href="https://www.rcsb.org/structure/5X72">5x72</a>) was used as an example to demonstrate the ability of the AutoDock Vina to dock successfully multiple ligands. The two inhibitors in this structure are stereoisomers, and only the R-isomer is able to bind in a specific region of the pocket, while both the R- and S-isomers can bind to the second location.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires a certain degree of familiarity with the command-line interface. Also, we assume that you installed the ADFR software suite as well as the meeko Python package.</p>
</div>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/mulitple_ligands_docking/data</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/mulitple_ligands_docking">GitHub</a>). If you ever feel lost, you can always take a look at the solution here: <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/mulitple_ligands_docking/solution</span></code>. All the Python scripts used here (except for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> and <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>) are located in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/autodock_scripts</span></code> directory, alternatively you can also find them here on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">GitHub</a>.</p>
</section>
<section id="preparing-the-flexible-receptor">
<h4>1. Preparing the flexible receptor<a class="headerlink" href="#preparing-the-flexible-receptor" title="Permalink to this headline"></a></h4>
<p>Exactly like the <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a> tutorial, the method requires a receptor coordinate file that includes all hydrogen atoms. The file <code class="docutils literal notranslate"><span class="pre">5x72_receptorH.pdb</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">data</span></code> directory located at <code class="docutils literal notranslate"><span class="pre">&lt;autodock-vina_directory&gt;/example/multiple_ligands_docking/</span></code>). This file contains the receptor coordinates taken from the PDB entry <code class="docutils literal notranslate"><span class="pre">5x72</span></code>. It was manually obtained by extracting the receptor coordinates (using an text editor) from the original PDB file <code class="docutils literal notranslate"><span class="pre">5x72.pdb</span></code> in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory, and the hydrogen atoms added using <a class="reference external" href="http://kinemage.biochem.duke.edu/software/reduce.php">reduce</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ prepare_receptor -r 5x72_receptorH.pdb -o 5x72_receptor.pdbqt
</pre></div>
</div>
<p>If you are not sure about this step, the output PDBQT file <code class="docutils literal notranslate"><span class="pre">5x72_receptor.pdbqt</span></code> is available in the <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="prepare-ligands">
<h4>2. Prepare ligands<a class="headerlink" href="#prepare-ligands" title="Permalink to this headline"></a></h4>
<p>Here, we will prepare two ligands instead of only one. We will start from the SDF files <code class="docutils literal notranslate"><span class="pre">5x72_ligand_p59.sdf</span></code> and <code class="docutils literal notranslate"><span class="pre">5x72_ligand_p69.sdf</span></code> located in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory. They were also obtained directly from the <a class="reference external" href="https://www.rcsb.org">PDB</a> here: <a class="reference external" href="https://www.rcsb.org/structure/5X72">5x72</a> (see <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">instance</span> <span class="pre">Coordinates</span></code> link for the P59 and P69 molecules). Since the ligand files do not include the hydrogen atoms, we are going to automatically add them.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We strongly advice you against using PDB format for preparing small molecules, since it does not contain information about bond connections. Please don’t forget to always check the protonation state of your molecules before docking. Your success can sometimes hang by just an hydrogen atom. ;-)</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mk_prepare_ligand.py -i 5x72_ligand_p59.sdf -o 5x72_ligand_p59.pdbqt
$ mk_prepare_ligand.py -i 5x72_ligand_p69.sdf -o 5x72_ligand_p69.pdbqt
</pre></div>
</div>
<p>The output PDBQT <code class="docutils literal notranslate"><span class="pre">5x72_ligand_p59.pdbqt</span></code> and <code class="docutils literal notranslate"><span class="pre">5x72_ligand_p69.pdbqt</span></code> can be found in the <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="optional-generating-affinity-maps-for-autodock-ff">
<h4>3. (Optional) Generating affinity maps for AutoDock FF<a class="headerlink" href="#optional-generating-affinity-maps-for-autodock-ff" title="Permalink to this headline"></a></h4>
<p>As well as for the docking with a fully rigid receptor, we need to generate a GPF file to precalculate the affinity maps for each atom type. However, instead of using the full receptor, affinity maps will be calculated only for the rigid part of the receptor (<code class="docutils literal notranslate"><span class="pre">5x72_receptor.pdbqt</span></code>).</p>
<p>To prepare the GPF file for the rigid part of the receptor:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pythonsh &lt;script_directory&gt;/prepare_gpf.py -l 5x72_ligand_p59.pdbqt -r 5x72_receptor.pdbqt <span class="se">\</span>
           -p <span class="nv">npts</span><span class="o">=</span><span class="s1">&#39;80,64,64&#39;</span> -p <span class="nv">gridcenter</span><span class="o">=</span><span class="s1">&#39;-15 15 129&#39;</span> -o 5x72_receptor.gpf
</pre></div>
</div>
<p>This time we manually specified the center of the grid <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">gridcenter='-15</span> <span class="pre">15</span> <span class="pre">129'</span></code> as well as its size <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">npts='80,64,64'</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Content of the grid parameter file (<strong>5x72_receptor.gpf</strong>) for the receptor (<strong>5x72_receptor.pdbqt</strong>)</span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npts 80 64 64                        # num.grid points in xyz</span>
<span class="go">gridfld 5x72_receptor.maps.fld       # grid_data_file</span>
<span class="go">spacing 0.375                        # spacing(A)</span>
<span class="go">receptor_types A C NA OA N SA HD     # receptor atom types</span>
<span class="go">ligand_types A C F OA N HD           # ligand atom types</span>
<span class="go">receptor 5x72_receptor.pdbqt         # macromolecule</span>
<span class="go">gridcenter -15.000 15.000 129.000    # xyz-coordinates or auto</span>
<span class="go">smooth 0.5                           # store minimum energy w/in rad(A)</span>
<span class="go">map 5x72_receptor.A.map              # atom-specific affinity map</span>
<span class="go">map 5x72_receptor.C.map              # atom-specific affinity map</span>
<span class="go">map 5x72_receptor.F.map              # atom-specific affinity map</span>
<span class="go">map 5x72_receptor.OA.map             # atom-specific affinity map</span>
<span class="go">map 5x72_receptor.N.map              # atom-specific affinity map</span>
<span class="go">map 5x72_receptor.HD.map             # atom-specific affinity map</span>
<span class="go">elecmap 5x72_receptor.e.map          # electrostatic potential map</span>
<span class="go">dsolvmap 5x72_receptor.d.map              # desolvation potential map</span>
<span class="go">dielectric -0.1465                   # &lt;0, AD4 distance-dep.diel;&gt;0, constant</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You might have to manually edit the GPF file and add addtional atom types if the second ligand contains different atom types not present in the ligand used for creating the GPF file.</p>
</div>
<p>To execute <code class="docutils literal notranslate"><span class="pre">autogrid4</span></code> using <code class="docutils literal notranslate"><span class="pre">5x72_receptor.gpf</span></code>, run the folllowing command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ autogrid4 -p 5x72_receptor.gpf -l 5x72_receptor_rigid.glg
</pre></div>
</div>
<p>You should obtain as well the following files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1fpu_receptor.maps.fld       # grid data file</span>
<span class="go">1fpu_receptor.*.map          # affinity maps for A, C, HD, NA, N, OA atom types</span>
<span class="go">1fpu_receptor.d.map          # desolvation map</span>
<span class="go">1fpu_receptor.e.map          # electrostatic map</span>
</pre></div>
</div>
</section>
<section id="running-autodock-vina">
<h4>4. Running AutoDock Vina<a class="headerlink" href="#running-autodock-vina" title="Permalink to this headline"></a></h4>
<section id="a-using-autodock4-forcefield">
<h5>4.a. Using AutoDock4 forcefield<a class="headerlink" href="#a-using-autodock4-forcefield" title="Permalink to this headline"></a></h5>
<p>When using the AutoDock4 forcefield, you only need to provide the affinity maps and the ligand, while specifying that the forcefield used will be AutoDock4 using the option <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">ad4</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --ligand 5x72_ligand_p59.pdbqt 5x72_ligand_p69.pdbqt --maps 5x72_receptor <span class="se">\</span>
       --scoring ad4 --exhaustiveness <span class="m">32</span> --out 5x72_ligand_ad4_out.pdbqt
</pre></div>
</div>
</section>
<section id="b-using-vina-forcefield">
<h5>4.b. Using Vina forcefield<a class="headerlink" href="#b-using-vina-forcefield" title="Permalink to this headline"></a></h5>
<p>As well as for the fully rigid molecular docking, you only need to specify the center and dimensions (in Angstrom) of the grid. Here, instead of specifying each parameters for the grid box using the arguments <code class="docutils literal notranslate"><span class="pre">--center_x,</span> <span class="pre">--center_y,</span> <span class="pre">--center_z</span></code> and <code class="docutils literal notranslate"><span class="pre">--size_x,</span> <span class="pre">--size_y,</span> <span class="pre">--size_z</span></code>, we will also store all those informations in a text file <code class="docutils literal notranslate"><span class="pre">5x72_receptor_vina_box.txt</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Content of the config file (<strong>5x72_receptor_vina_box.txt</strong>) for AutoDock Vina</span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">center_x = -15</span>
<span class="go">center_y = 15</span>
<span class="go">center_z = 129</span>
<span class="go">size_x = 30</span>
<span class="go">size_y = 24</span>
<span class="go">size_z = 24</span>
</pre></div>
</div>
</div>
<p>However, when using the Vina forcefield, you will need to specify the receptor <code class="docutils literal notranslate"><span class="pre">5x72_receptor.pdbqt</span></code> (needed to compute internally the affinity maps). To perform the same docking experiment but using Vina forcefield run the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --receptor 5x72_receptor.pdbqt --ligand 5x72_ligand_p59.pdbqt 5x72_ligand_p69.pdbqt <span class="se">\</span>
       --config 5x72_receptor_vina_box.txt <span class="se">\</span>
       --exhaustiveness <span class="m">32</span> --out 5x72_ligand_vina_out.pdbqt
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, you can use the Vinardo forcefield by adding the <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">vinardo</span></code> option.</p>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">5x72_ligand_flex_vina_out.pdbqt</span></code>.</p>
</section>
</section>
<section id="results">
<h4>5. Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please don’t forget that energy scores giving by the AutoDock and Vina forcefield are not comparable between each other.</p>
</div>
<section id="a-using-autodock-forcefield">
<h5>5.a. Using AutoDock forcefield<a class="headerlink" href="#a-using-autodock-forcefield" title="Permalink to this headline"></a></h5>
<p>The predicted free energy of binding should be about <code class="docutils literal notranslate"><span class="pre">-18</span> <span class="pre">kcal/mol</span></code> for poses that are similar to the crystallographic pose. Using the AutoDock4 scoring function, the first two sets of poses (top 2) need to be considered to show also a good overlap with the crystallographic poses</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : ad4</span>
<span class="go">Ligands:</span>
<span class="go">  - 5x72_ligand_p59.pdbqt</span>
<span class="go">  - 5x72_ligand_p69.pdbqt</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Reading AD4.2 maps ... done.</span>
<span class="go">Performing docking (random seed: 1295744643) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -18.94          0          0</span>
<span class="go">   2       -18.62      1.634      3.349</span>
<span class="go">   3        -18.4      1.413      3.312</span>
<span class="go">   4       -18.24      1.341      3.921</span>
<span class="go">   5       -18.03      1.599      9.262</span>
<span class="go">   6       -17.93      1.631      9.166</span>
<span class="go">   7       -17.84      1.928      4.933</span>
<span class="go">   8       -17.74       1.74      8.879</span>
<span class="go">   9       -17.74          2      9.433</span>
</pre></div>
</div>
</section>
<section id="id4">
<h5>5.b. Using Vina forcefield<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h5>
<p>Using the vina forcefield, you should obtain a similar output from Vina with the best score around <code class="docutils literal notranslate"><span class="pre">-21</span> <span class="pre">kcal/mol</span></code>. Using the Vina scoring function, the best set of poses (top 1) shows an excellent overlap with the crystallographic coordinates for one of the isomers.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : vina</span>
<span class="go">Rigid receptor: 5x72_receptor.pdbqt</span>
<span class="go">Ligands:</span>
<span class="go">  - 5x72_ligand_p59.pdbqt</span>
<span class="go">  - 5x72_ligand_p69.pdbqt</span>
<span class="go">Center: X -15 Y 15 Z 129</span>
<span class="go">Size: X 30 Y 24 Z 24</span>
<span class="go">Grid space: 0.375</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Computing Vina grid ... done.</span>
<span class="go">Performing docking (random seed: -2141167371) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -21.32          0          0</span>
<span class="go">   2       -20.94      1.061      3.648</span>
<span class="go">   3       -20.73      1.392      3.181</span>
<span class="go">   4       -19.93      1.744      4.841</span>
<span class="go">   5       -19.34      1.384      3.352</span>
<span class="go">   6       -19.05      1.185      9.184</span>
<span class="go">   7        -18.9      1.198      3.586</span>
<span class="go">   8       -18.76      1.862      8.986</span>
<span class="go">   9       -18.63      1.749      9.194</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-docking_zinc"></span><section id="docking-with-zinc-metalloproteins">
<span id="zinc-docking"></span><h3>Docking with zinc metalloproteins<a class="headerlink" href="#docking-with-zinc-metalloproteins" title="Permalink to this headline"></a></h3>
<p>Zinc is present in a wide variety of proteins and is important in the metabolism of most organisms. Zinc metalloenzymes are therapeutically relevant targets in diseases such as cancer, heart disease, bacterial infection, and Alzheimer’s disease. In most cases a drug molecule targeting such enzymes establishes an interaction that coordinates with the zinc ion. Thus, accurate prediction of the interaction of ligands with zinc is an important aspect of computational docking and virtual screening against zinc containing proteins.</p>
<p>The AutoDock4 force field was extended to include a specialized potential describing the interactions of zinc-coordinating ligands. This potential describes both the energetic and geometric components of the interaction. The new force field, named AutoDock4Zn, was calibrated on a data set of 292 crystal complexes containing zinc. Redocking experiments show that the force field provides significant improvement in performance in both free energy of binding estimation as well as in root-mean-square deviation from the crystal structure pose.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires a certain degree of familiarity with the command-line interface. Also, we assume that you installed the ADFR software suite as well as the meeko Python package.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite this paper if you are using this protocol in your work:</p>
<ul class="simple">
<li><p>Santos-Martins, D., Forli, S., Ramos, M. J., &amp; Olson, A. J. (2014). AutoDock4Zn: an improved AutoDock force field for small-molecule docking to zinc metalloproteins. Journal of chemical information and modeling, 54(8), 2371-2379.</p></li>
</ul>
</div>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/docking_with_zinc_metalloproteins/data</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/docking_with_zinc_metalloproteins">GitHub</a>). If you ever feel lost, you can always take a look at the solution here: <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/docking_with_zinc_metalloproteins/solution</span></code>. All the Python scripts used here (except for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> and <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>) are located in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/autodock_scripts</span></code> directory, alternatively you can also find them here on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">GitHub</a>.</p>
</section>
<section id="preparing-the-receptor">
<h4>1. Preparing the receptor<a class="headerlink" href="#preparing-the-receptor" title="Permalink to this headline"></a></h4>
<p>During this step we will create the PDBQT file of the receptor using the PDB file called <code class="docutils literal notranslate"><span class="pre">proteinH.pdb</span></code>, containing all the hydrogen atoms, and add the tetrahedral zinc pseudo atoms (<code class="docutils literal notranslate"><span class="pre">TZ</span></code>) around the zinc ion. TZ atoms represent the preferred position for tetrahedral coordination by the ligand. This file contains the receptor coordinates of chain A and B taken from the PDB entry <a class="reference external" href="https://www.rcsb.org/structure/1S63">1s63</a>.</p>
<p>To prepare the receptor, execute the following command lines:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ prepare_receptor -r protein.pdb -o protein.pdbqt
$ pythonsh &lt;script_directory&gt;/zinc_pseudo.py -r protein.pdbqt -o protein_tz.pdbqt
</pre></div>
</div>
<p>The execution of these two commands should output these two messages. One informing us that the charge for the zinc ion was not set by <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code>. In this context, the message can be safely ignored since the ligand will interact preferentially with the zinc pseudo atoms (TZ). The PDBQT output files can be found in the <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Sorry, there are no Gasteiger parameters available for atom proteinH:B: ZN1001:ZN</span>
</pre></div>
</div>
<p>The second message is telling us that only one zinc pseudo atom (TZ) was added to the receptor.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Wrote 1 TZ atoms on protein_tz.pdbqt.</span>
</pre></div>
</div>
</section>
<section id="preparing-the-ligand">
<h4>2. Preparing the ligand<a class="headerlink" href="#preparing-the-ligand" title="Permalink to this headline"></a></h4>
<p>The second step consists to prepare the ligand, by converting the SDF file <code class="docutils literal notranslate"><span class="pre">1s63_ligand.msdf</span></code> to a PDBQT file readable by AutoDock Vina. As usual, we will use the <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code> Python script from <code class="docutils literal notranslate"><span class="pre">Meeko</span></code> (see installation instruction here: <a class="reference internal" href="index.html#docking-requirements"><span class="std std-ref">Software requirements</span></a>) for this task. For your convenience, the molecule file <code class="docutils literal notranslate"><span class="pre">1s63_ligand.sdf</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). But you can obtain it directly from the <a class="reference external" href="https://www.rcsb.org">PDB</a> here: <a class="reference external" href="https://www.rcsb.org/structure/1S63">1s63</a> (see <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">instance</span> <span class="pre">Coordinates</span></code> link for the 778 molecule. Since the ligand file does not include the hydrogen atoms, we are going to automatically add them.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mk_prepare_ligand.py -i 1s63_ligand.sdf -o 1s63_ligand.pdbqt
</pre></div>
</div>
<p>The output PDBQT  <code class="docutils literal notranslate"><span class="pre">1s63_ligand.pdbqt</span></code> can be found in the <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="generating-affinity-maps">
<h4>3. Generating affinity maps<a class="headerlink" href="#generating-affinity-maps" title="Permalink to this headline"></a></h4>
<p>The preparation script <code class="docutils literal notranslate"><span class="pre">prepare_gpf4zn.py</span></code> will be used to generate a special GPF file for docking with zinc pseudo atoms:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pythonsh &lt;script_directory&gt;/prepare_gpf4zn.py -l 1s63_ligand.pdbqt -r protein_tz.pdbqt <span class="se">\</span>
-o protein_tz.gpf  -p <span class="nv">npts</span><span class="o">=</span><span class="m">40</span>,30,50 -p <span class="nv">gridcenter</span><span class="o">=</span><span class="m">18</span>,134,-1 <span class="se">\</span>
–p <span class="nv">parameter_file</span><span class="o">=</span>AD4Zn.dat
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-p</span></code> flag is used to set the box center (<code class="docutils literal notranslate"><span class="pre">gridcenter</span></code>) and size (<code class="docutils literal notranslate"><span class="pre">npts</span></code>) along with the <code class="docutils literal notranslate"><span class="pre">parameter_file</span></code> specific for this case. After execution, you should obtain a GPF file called <code class="docutils literal notranslate"><span class="pre">protein_tz.gpf</span></code> containing this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npts 40 30 50                        # num.grid points in xyz</span>
<span class="go">parameter_file AD4Zn.dat             # force field default parameter file</span>
<span class="go">gridfld protein_tz.maps.fld          # grid_data_file</span>
<span class="go">spacing 0.375                        # spacing(A)</span>
<span class="go">receptor_types A C TZ NA ZN OA N P SA HD # receptor atom types</span>
<span class="go">ligand_types A C Cl NA OA N HD       # ligand atom types</span>
<span class="go">receptor protein_tz.pdbqt            # macromolecule</span>
<span class="go">gridcenter 18 134 -1                 # xyz-coordinates or auto</span>
<span class="go">smooth 0.5                           # store minimum energy w/in rad(A)</span>
<span class="go">map protein_tz.A.map                 # atom-specific affinity map</span>
<span class="go">map protein_tz.C.map                 # atom-specific affinity map</span>
<span class="go">map protein_tz.Cl.map                # atom-specific affinity map</span>
<span class="go">map protein_tz.NA.map                # atom-specific affinity map</span>
<span class="go">map protein_tz.OA.map                # atom-specific affinity map</span>
<span class="go">map protein_tz.N.map                 # atom-specific affinity map</span>
<span class="go">map protein_tz.HD.map                # atom-specific affinity map</span>
<span class="go">elecmap protein_tz.e.map             # electrostatic potential map</span>
<span class="go">dsolvmap protein_tz.d.map              # desolvation potential map</span>
<span class="go">dielectric -0.1465                   # &lt;0, AD4 distance-dep.diel;&gt;0, constant</span>
<span class="go">nbp_r_eps 0.25 23.2135 12 6 NA TZ</span>
<span class="go">nbp_r_eps 2.1   3.8453 12 6 OA Zn</span>
<span class="go">nbp_r_eps 2.25  7.5914 12 6 SA Zn</span>
<span class="go">nbp_r_eps 1.0   0.0    12 6 HD Zn</span>
<span class="go">nbp_r_eps 2.0   0.0060 12 6 NA Zn</span>
<span class="go">nbp_r_eps 2.0   0.2966 12 6  N Zn</span>
</pre></div>
</div>
<p>The AutoDock4Zn forcefield is mostly defined by non bonded pairwise potentials which are written to the GPF file <code class="docutils literal notranslate"><span class="pre">protein_tz.gpf</span></code> in the form of <code class="docutils literal notranslate"><span class="pre">npb_r_eps</span></code> keywords. The file <code class="docutils literal notranslate"><span class="pre">AD4Zn.dat</span></code> includes the definition of the TZ atom type for the AutoDock forcefield. The keyword <code class="docutils literal notranslate"><span class="pre">parameter_file</span></code> in the GPF file specifies <code class="docutils literal notranslate"><span class="pre">AD4Zn.dat</span></code> as the forcefield to be used, so AutoGrid requires a local copy of it in the working directory. Alternatively, the keyword <code class="docutils literal notranslate"><span class="pre">parameter_file</span></code> in the GPF can point to the full or relative path where <code class="docutils literal notranslate"><span class="pre">AD4Zn.dat</span></code> is located.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The behavior of the <code class="docutils literal notranslate"><span class="pre">npb_r_eps</span></code> keyword changed between autogrid 4.2.6 and 4.2.7. Be sure that you are using the latest version (AutoGrid 4.2.7.x.2019-07-11) of autogrid4 shipped with the ADFR Suite.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ autogrid4 -p protein_tz.gpf -l protein_tz.glg
</pre></div>
</div>
<p>At this stage, all forcefield information has been encoded in the affinity maps, and the remaining steps are the same as in the standard AutoDock protocol.</p>
</section>
<section id="running-autodock-vina">
<h4>4. Running AutoDock Vina<a class="headerlink" href="#running-autodock-vina" title="Permalink to this headline"></a></h4>
<section id="a-using-autodock4-forcefield">
<h5>4.a. Using AutoDock4 forcefield<a class="headerlink" href="#a-using-autodock4-forcefield" title="Permalink to this headline"></a></h5>
<p>When using the AutoDock4 forcefield, you only need to provide the affinity maps and the ligand, while specifying that the forcefield used will be AutoDock4 using the option <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">ad4</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --ligand 1s63_ligand.pdbqt --maps protein_tz --scoring ad4 <span class="se">\</span>
       --exhaustiveness <span class="m">32</span> --out 1s63_ligand_ad4_out.pdbqt
</pre></div>
</div>
</section>
</section>
<section id="results">
<h4>5. Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h4>
<p>The predicted free energy of binding should be about <code class="docutils literal notranslate"><span class="pre">-13</span> <span class="pre">kcal/mol</span></code> for the best pose and should corresponds to the crystallographic pose.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : ad4</span>
<span class="go">Ligand: 1s63_ligand.pdbqt</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Reading AD4.2 maps ... done.</span>
<span class="go">Performing docking (random seed: 1984557646) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1        -13.5          0          0</span>
<span class="go">   2          -13      2.518      4.707</span>
<span class="go">   3       -12.56      2.116      2.499</span>
<span class="go">   4       -12.44      3.041      4.021</span>
<span class="go">   5       -12.12      2.975      6.211</span>
<span class="go">   6       -11.96      2.814      6.336</span>
<span class="go">   7       -11.91      3.244      6.477</span>
<span class="go">   8       -11.32      3.783      5.654</span>
<span class="go">   9       -11.31      2.856      3.867</span>
</pre></div>
</div>
</section>
</section>
<span id="document-docking_hydrated"></span><section id="hydrated-docking">
<span id="id1"></span><h3>Hydrated docking<a class="headerlink" href="#hydrated-docking" title="Permalink to this headline"></a></h3>
<p>In physiological environments, proteins and other biological structures are surrounded by water molecules. When a small-molecule binds to a protein, it must displace most of the waters occupying the binding cavity. However, rarely are all water molecules displaced. Some waters can be so strongly bound and conserved among similar proteins that from a ligand-docking perspective they are considered a part of the target structure, altering the binding site topography.</p>
<p>Thus a method was developed that uses the existing version of AutoDock4 and now the new version AutoDock Vina 1.2.x but modifies the force field to model explicit bridging water molecules. In tests, this method has shown improvement in the prediction of bound conformations of small fragment molecules, such as those used in fragment-based drug discovery. The protocol can be summarized by those steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The ligand is decorated with an ensemble of water molecules (represented by dummy atoms), which may or may not then contribute to the intermolecular interactions.</p></li>
<li><p>A modified AutoGrid map is then used during docking, giving a favorable score when the water is well placed and omitting the water if it overlaps with the receptor.</p></li>
<li><p>Finally, docked results are analyzing and poses are rescored using only water molecules that were retained.</p></li>
</ol>
</div></blockquote>
<p>In this tutorial, we are going to dock a fragment-size ligand (nicotine) with explicit water molecules in the acetylcholine binding protein (AChBP) structure (PDB entry <a class="reference external" href="https://www.rcsb.org/structure/1UW6">1uw6</a>). It was shown that the absence of water molecules could have a dramatic influence in docking performance leading to either inaccurate scoring and/or incorrect pose. With hydrated docking, fragment-sized ligands show a overall RMSD improvement.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires a certain degree of familiarity with the command-line interface. Also, we assume that you installed the ADFR software suite as well as the meeko Python package.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The materials present is this tutorial can be also found here: <a class="reference external" href="https://www.nature.com/articles/nprot.2016.051">https://www.nature.com/articles/nprot.2016.051</a>. If you are using this tutorial or this docking method for your work, you can cite the following papers:</p>
<ul class="simple">
<li><p>Forli, S., &amp; Olson, A. J. (2012). A force field with discrete displaceable waters and desolvation entropy for hydrated ligand docking. Journal of medicinal chemistry, 55(2), 623-638.</p></li>
<li><p>Forli, S., Huey, R., Pique, M. E., Sanner, M. F., Goodsell, D. S., &amp; Olson, A. J. (2016). Computational protein–ligand docking and virtual drug screening with the AutoDock suite. Nature protocols, 11(5), 905-919.</p></li>
</ul>
</div>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/hydrated_docking/data</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/hydrated_docking">GitHub</a>). If you ever feel lost, you can always take a look at the solution here: <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/hydrated_docking/solution</span></code>. All the Python scripts used here (except for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> and <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>) are located in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/autodock_scripts</span></code> directory, alternatively you can also find them here on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">GitHub</a>.</p>
</section>
<section id="preparing-the-receptor">
<h4>1. Preparing the receptor<a class="headerlink" href="#preparing-the-receptor" title="Permalink to this headline"></a></h4>
<p>The receptor can be prepared using the method described earlier in the following tutorials: <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a> or <a class="reference internal" href="index.html#flexible-docking"><span class="std std-ref">Flexible docking</span></a> if one wants to incorporate some sidechain flexibility. The file <code class="docutils literal notranslate"><span class="pre">1uw6_receptorH.pdb</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">data</span></code> directory located at <code class="docutils literal notranslate"><span class="pre">&lt;autodock-vina_directory&gt;/example/hydrated_docking/</span></code>). This file contains the receptor coordinates of chain A and B taken from the PDB entry <code class="docutils literal notranslate"><span class="pre">1uw6</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ prepare_receptor -r 1uw6_receptorH.pdb -o 1uw6_receptor.pdbqt
</pre></div>
</div>
<p>The output PDBQT file <code class="docutils literal notranslate"><span class="pre">1uw6_receptor.pdbqt</span></code> is available in <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory if necessary.</p>
</section>
<section id="preparing-the-ligand">
<h4>2. Preparing the ligand<a class="headerlink" href="#preparing-the-ligand" title="Permalink to this headline"></a></h4>
<p>For the hydrated docking, explicit water molecules (W atoms) must be added to the molecule. And for that, we will use <code class="docutils literal notranslate"><span class="pre">Meeko</span></code> (see installation instruction here: <a class="reference internal" href="index.html#docking-requirements"><span class="std std-ref">Software requirements</span></a>). For convenience, the molecule file <code class="docutils literal notranslate"><span class="pre">1uw6_ligand.sdf</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">data</span></code> directory). But you can obtain it directly from the <a class="reference external" href="https://www.rcsb.org">PDB</a> here: <a class="reference external" href="https://www.rcsb.org/structure/1UW6">1uw6</a> (see <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">instance</span> <span class="pre">Coordinates</span></code> link for the NCT molecule (chain U [A])). Since the ligand file does not include the hydrogen atoms, we are going to automatically add them. The option <code class="docutils literal notranslate"><span class="pre">-w</span></code> is use to add explicit water molecule to the molecule.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We strongly advice you against using PDB format for preparing small molecules, since it does not contain information about bond connections. Please don’t forget to always check the protonation state of your molecules before docking. Your success can sometimes hang by just an hydrogen atom. ;-)</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mk_prepare_ligand.py -i 1uw6_ligand.sdf -o 1uw6_ligand.pdbqt -w
</pre></div>
</div>
<p>In total, 2 water molecules were added to the fragment. If you were not able to generate the <code class="docutils literal notranslate"><span class="pre">1uw6_ligand.pdbqt</span></code> file, you can look at the <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="generating-affinity-maps">
<h4>3. Generating affinity maps<a class="headerlink" href="#generating-affinity-maps" title="Permalink to this headline"></a></h4>
<p>As well as for the <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a> or <a class="reference internal" href="index.html#flexible-docking"><span class="std std-ref">Flexible docking</span></a> tutorials, we will also need to calculate the affinity maps for each atom types present in the ligand. However, this time we will also need to craft a special <code class="docutils literal notranslate"><span class="pre">W</span></code> affinity map for the water molecules attached to the ligand. This <code class="docutils literal notranslate"><span class="pre">W</span></code> affinity map is obtained by combining the <code class="docutils literal notranslate"><span class="pre">OA</span></code> and <code class="docutils literal notranslate"><span class="pre">HD</span></code> grid maps, therefore we are going to use the <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">ligand_types='A,C,OA,N,HD'</span></code> option to be sure those atom types are included in the GPF, in addition of the ligand atom types, while ignoring the <code class="docutils literal notranslate"><span class="pre">W</span></code> atom type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pythonsh &lt;script_directory&gt;/prepare_gpf.py -l 1uw6_ligand.pdbqt -r 1uw6_receptor.pdbqt -y <span class="se">\</span>
           -p <span class="nv">ligand_types</span><span class="o">=</span><span class="s1">&#39;A,NA,C,HD,N,OA&#39;</span> <span class="se">\</span>
</pre></div>
</div>
<p>The option <code class="docutils literal notranslate"><span class="pre">-y</span></code> specifies that we want to center automatically the grid around the ligand. After manually adding the <code class="docutils literal notranslate"><span class="pre">OA</span></code> atom type, you should have a GPF file called <code class="docutils literal notranslate"><span class="pre">1uw6_receptor.gpf</span></code> that looks like this:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Content of the grid parameter file (<strong>1uw6_receptor.gpf</strong>) for the receptor (<strong>1uw6_receptor.pdbqt</strong>)</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npts 40 40 40                        # num.grid points in xyz</span>
<span class="go">gridfld 1uw6_receptor.maps.fld       # grid_data_file</span>
<span class="go">spacing 0.375                        # spacing(A)</span>
<span class="go">receptor_types A C NA OA N SA HD     # receptor atom types</span>
<span class="go">ligand_types A NA C HD N OA          # ligand atom types</span>
<span class="go">receptor 1uw6_receptor.pdbqt         # macromolecule</span>
<span class="go">gridcenter 83.640 69.684 -10.124     # xyz-coordinates or auto</span>
<span class="go">smooth 0.5                           # store minimum energy w/in rad(A)</span>
<span class="go">map 1uw6_receptor.A.map              # atom-specific affinity map</span>
<span class="go">map 1uw6_receptor.NA.map             # atom-specific affinity map</span>
<span class="go">map 1uw6_receptor.C.map              # atom-specific affinity map</span>
<span class="go">map 1uw6_receptor.HD.map             # atom-specific affinity map * ADD OA IF NOT PRESENT *</span>
<span class="go">map 1uw6_receptor.N.map              # atom-specific affinity map</span>
<span class="go">map 1uw6_receptor.OA.map             # atom-specific affinity map * ADD OA IF NOT PRESENT *</span>
<span class="go">elecmap 1uw6_receptor.e.map          # electrostatic potential map</span>
<span class="go">dsolvmap 1uw6_receptor.d.map              # desolvation potential map</span>
<span class="go">dielectric -0.1465                   # &lt;0, AD4 distance-dep.diel;&gt;0, constant</span>
</pre></div>
</div>
</div>
<p>You can now execute <code class="docutils literal notranslate"><span class="pre">autogrid4</span></code> using the GPF file called <code class="docutils literal notranslate"><span class="pre">1uw6_receptor.gpf</span></code> and generate the additional water map <code class="docutils literal notranslate"><span class="pre">W</span></code> by combining <code class="docutils literal notranslate"><span class="pre">OA</span></code> and <code class="docutils literal notranslate"><span class="pre">HD</span></code> affinity maps using <code class="docutils literal notranslate"><span class="pre">mapwater.py</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ autogrid4 -p 1uw6_receptor.gpf -l 1uw6_receptor.glg
$ python &lt;script_directory&gt;/mapwater.py -r 1uw6_receptor.pdbqt -s 1uw6_receptor.W.map
</pre></div>
</div>
<p>For more informations about the <code class="docutils literal notranslate"><span class="pre">mapwater.py</span></code> command tool and all the available options, just type <code class="docutils literal notranslate"><span class="pre">mapwater.py</span></code>. After executing this command, you should obtain a new affinity map called <code class="docutils literal notranslate"><span class="pre">1uw6_receptor.W.map</span></code> and the following the output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ADD PWD AND FILE SUMMARY</span>
<span class="go">  receptor :  1uw6_receptor.pdbqt</span>
<span class="go">      OA map -&gt; 1uw6_receptor.OA.map</span>
<span class="go">      HD map -&gt; 1uw6_receptor.HD.map</span>
<span class="go"> =&gt; Water map weight : DEFAULT [ 0.60 ]</span>

<span class="go">  MapWater generator</span>
<span class="go"> =====================</span>
<span class="go">  mode      :  BEST</span>
<span class="go">  weight    :   0.6</span>
<span class="go">  HD_weight :   1.0</span>
<span class="go">  OA_weight :   1.0</span>
<span class="go">  entropy   :   -0.2</span>

<span class="go">     Output info</span>
<span class="go">  --------------------</span>
<span class="go">  filename  : 1uw6_receptor.W.map</span>
<span class="go">  OA points : 91.73%</span>
<span class="go">  HD points : 8.27%</span>

<span class="go">  lowest  map value : -0.99</span>
<span class="go">  highest map value : -0.01</span>
</pre></div>
</div>
</section>
<section id="running-autodock-vina">
<h4>4. Running AutoDock Vina<a class="headerlink" href="#running-autodock-vina" title="Permalink to this headline"></a></h4>
<section id="a-using-autodock4-forcefield">
<h5>4.a. Using AutoDock4 forcefield<a class="headerlink" href="#a-using-autodock4-forcefield" title="Permalink to this headline"></a></h5>
<p>Now that you generated the ligand with explicit water molecules attached (<code class="docutils literal notranslate"><span class="pre">1uw6_ligand.pdbqt</span></code>) and the extra affinity map for the <code class="docutils literal notranslate"><span class="pre">W</span></code> atom type (<code class="docutils literal notranslate"><span class="pre">1uw6_receptor.W.map</span></code>), you can do the molecular docking with Vina using the AutoDock4 forcefield:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina  --ligand 1uw6_ligand.pdbqt --maps 1uw6_receptor --scoring ad4 <span class="se">\</span>
        --exhaustiveness <span class="m">32</span> --out 1uw6_ligand_ad4_out.pdbqt
</pre></div>
</div>
</section>
<section id="b-using-vina-forcefield">
<h5>4.b. Using Vina forcefield<a class="headerlink" href="#b-using-vina-forcefield" title="Permalink to this headline"></a></h5>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>While this method was calibrated and validated with the AutoDock4 forcefield, we strongly advice you against using this protocol with the Vina and Vinardo forcefield.</p>
</div>
</section>
</section>
<section id="results-and-post-processing">
<h4>5. Results and post-processing<a class="headerlink" href="#results-and-post-processing" title="Permalink to this headline"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware that with this implementation of the method, it is difficult to compare results obtained with very diverse ligands without doing extra of post-processing on the results, because the energy estimation needs to be normalized. For this reason, the method is not suitable for virtual screenings. This doesn’t affect the structural accuracy, so comparisons within docking poses are fine. An improved scoring function to overcome this issue is in the works.</p>
</div>
<p>The predicted free energy of binding should be about <code class="docutils literal notranslate"><span class="pre">-8</span> <span class="pre">kcal/mol</span></code> for poses that are similar to the crystallographic pose.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : ad4</span>
<span class="go">Ligand: 1uw6_ligand.pdbqt</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Reading AD4.2 maps ... done.</span>
<span class="go">Performing docking (random seed: -655217817) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -8.077          0          0</span>
<span class="go">   2        -7.63      2.038      2.684</span>
<span class="go">   3       -7.382      2.378      2.747</span>
<span class="go">   4        -7.27      2.063      2.538</span>
<span class="go">   5       -7.138      1.861      5.391</span>
<span class="go">   6       -7.129          2      2.542</span>
<span class="go">   7       -7.078      3.307      5.442</span>
<span class="go">   8       -7.065       2.22      4.872</span>
<span class="go">   9       -7.051      3.135      5.636</span>
</pre></div>
</div>
<p>Docking results are filtered by using the receptor to remove displaced waters and the W map file to rank the conserved ones as strong or weak water molecules.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python &lt;script_directory&gt;/dry.py -r 1uw6_receptor.pdbqt -m 1uw6_receptor.W.map -i 1uw6_ligand_ad4_out.pdbqt
</pre></div>
</div>
<p>For more informations about the <code class="docutils literal notranslate"><span class="pre">dry.py</span></code> command tool and all the available options, just type <code class="docutils literal notranslate"><span class="pre">dry.py</span></code>. Running the previous command should give you this output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">                  ____</span>
<span class="go">                 /\  _`\</span>
<span class="go">                 \ \ \/\ \  _ __  __  __</span>
<span class="go">                  \ \ \ \ \/\`&#39;__\\ \/\ \</span>
<span class="go">                   \ \ \_\ \ \ \/\ \ \_\ \</span>
<span class="go">                    \ \____/\ \_\ \/`____ \</span>
<span class="go">                     \/___/  \/_/  `/___/&gt; \</span>
<span class="go">                                      /\___/</span>
<span class="go">                                      \/__/</span>


<span class="go">========================== INPUT DATA =========================</span>
<span class="go"> importing ATOMS from  1uw6_ligand_ad4_out.pdbqt</span>

<span class="go"> [ using map file 1uw6_receptor.W.map ]</span>
<span class="go">===============================================================</span>


<span class="go"> receptor structure loaded           [ 4069 atoms ]</span>
<span class="go"> receptor 5A shell extracted             [ 480 atoms in 5 A shell ]</span>
<span class="go"> removing ligand/ligand overlapping waters    [ 5 water(s) removed ]</span>
<span class="go"> removing ligand/receptor overlapping waters      [ 8 water(s) removed ]</span>

<span class="go"> scanning grid map for conserved waters...    [ filtered pose contains 5 waters ]</span>

<span class="go"> water grid score results [ map: 1uw6_receptor.W.map ]</span>
<span class="go">     [ Water STRONG ( -0.92 ) +++ ]</span>
<span class="go">     [ Water STRONG ( -0.66 ) +++ ]</span>
<span class="go">     [ Water  WEAK  ( -0.50 )  +  ]</span>
<span class="go">     [ Water STRONG ( -0.83 ) +++ ]</span>
<span class="go">     [ Water STRONG ( -0.99 ) +++ ]</span>
</pre></div>
</div>
<p>Waters are ranked (STRONG, WEAK) and scored inside the output file <code class="docutils literal notranslate"><span class="pre">1uw6_ligand_ad4_out_DRY_SCORED.pdbqt</span></code> with the calculated energy.</p>
</section>
</section>
<span id="document-docking_macrocycle"></span><section id="docking-with-macrocycles">
<span id="macrocycle-docking"></span><h3>Docking with macrocycles<a class="headerlink" href="#docking-with-macrocycles" title="Permalink to this headline"></a></h3>
<p>AutoDock Vina is not able to manage directly the flexibility associated with bonds in cyclic molecules. Different approaches can be used to dock macrocyclic molecules, like identifying one or more low energy conformations and docking them as different ligands, but generating them and docking them separately can be a time-consuming task. But AutoDock Vina (and AD4) has a specialized protocol to dock macrocycles while modeling their flexibility on-the-fly.</p>
<p>The current implementation is described in our paper on the D3R Grand Challenge 4 (see below) and is summarized herein:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>One of the bonds in the ring structure is broken, resulting in an open form of the macrocycle that removes the need for correlated torsional variations, and enabling torsional degrees of freedom to be explored independently.</p></li>
<li><p>To each of the atoms of the broken bond, a dummy-atom is added. The distance between a dummy-atom and its parent atom is the same as the length of the broken bond, and the 1-3 angle also matches the original geometry.</p></li>
<li><p>During the docking, a linear attractive potential is applied on each dummy-atom to restore the bond resulting in the closed ring form. Thus, macrocycle conformations are sampled while adapting to the binding pocket, at the cost of increased search complexity with the added extra rotatable bonds.</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires a certain degree of familiarity with the command-line interface. Also, we assume that you installed the ADFR software suite as well as the meeko Python package.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using this tutorial for your works, you can cite the following paper:</p>
<ul class="simple">
<li><p>Forli, S., &amp; Botta, M. (2007). Lennard-Jones potential and dummy atom settings to overcome the AUTODOCK limitation in treating flexible ring systems. Journal of chemical information and modeling, 47(4), 1481-1492.</p></li>
<li><p>Santos-Martins, D., Eberhardt, J., Bianco, G., Solis-Vasquez, L., Ambrosio, F. A., Koch, A., &amp; Forli, S. (2019). D3R Grand Challenge 4: prospective pose prediction of BACE1 ligands with AutoDock-GPU. Journal of Computer-Aided Molecular Design, 33(12), 1071-1081.</p></li>
</ul>
</div>
<p>For this tutorial, we are going to use the dataset from the Drug Design Data Resource (D3R) Grand Challenge 4 (GC4) organized in 2018. For more information about the D3R organization and it role in the computer-aided drug discovery community: <a class="reference external" href="https://drugdesigndata.org/">https://drugdesigndata.org</a>. In second stage (1b) of this challenge, participants were asked to predict the bound poses of 20 BACE1 ligands knowing the crystallographic structure of the protein. A macrocycle is present in 19 out of 20 ligands, making pose predictions particularly challenging for the reasons described earlier. The docking procedure being the same for all 20 ligands, we are going to redock only one of the macrocycle in this tutorial.</p>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/docking_with_macrocycles/data</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/docking_with_macrocycles">GitHub</a>). If you ever feel lost, you can always take a look at the solution here: <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/docking_with_macrocycles/solution</span></code>. All the Python scripts used here (except for <code class="docutils literal notranslate"><span class="pre">prepare_receptor</span></code> and <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>) are located in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/autodock_scripts</span></code> directory, alternatively you can also find them here on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/autodock_scripts">GitHub</a>.</p>
</section>
<section id="preparing-the-receptor">
<h4>1. Preparing the receptor<a class="headerlink" href="#preparing-the-receptor" title="Permalink to this headline"></a></h4>
<p>The receptor can be prepared using the method described earlier in the following tutorials: <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a>. The file <code class="docutils literal notranslate"><span class="pre">BACE_1_receptorH.pdb</span></code> is provided (see <code class="docutils literal notranslate"><span class="pre">data</span></code> directory located at <code class="docutils literal notranslate"><span class="pre">&lt;autodock-vina_directory&gt;/example/macrocycle_docking/</span></code>). This file contains the receptor coordinates of chain A.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ prepare_receptor -r BACE_1_receptorH.pdb -o BACE_1_receptor.pdbqt
</pre></div>
</div>
<p>The output PDBQT file <code class="docutils literal notranslate"><span class="pre">BACE_1_receptor.pdbqt</span></code> is available in <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory if necessary.</p>
</section>
<section id="preparing-the-ligand">
<h4>2. Preparing the ligand<a class="headerlink" href="#preparing-the-ligand" title="Permalink to this headline"></a></h4>
<p>For this particular tutorial we are going to use the python package <code class="docutils literal notranslate"><span class="pre">Meeko</span></code> for preparing the macrocycle ligand. If you didn’t install yet <code class="docutils literal notranslate"><span class="pre">Meeko</span></code> you can check the instruction here: <a class="reference internal" href="index.html#docking-requirements"><span class="std std-ref">Software requirements</span></a>. As well, the second step consists to prepare the ligand, by converting the MOL2 file <code class="docutils literal notranslate"><span class="pre">BACE_1_ligand.mol2</span></code> to a PDBQT file readable by AutoDock Vina. The MOL2 file is located in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ mk_prepare_ligand.py -i BACE_1_ligand.mol2 -m -o BACE_1_ligand.pdbqt
</pre></div>
</div>
<p>Different options are available for <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span></code>, type  <code class="docutils literal notranslate"><span class="pre">mk_prepare_ligand.py</span> <span class="pre">--help</span></code> for more details. If you are not sure about this step, the output PDBQT file <code class="docutils literal notranslate"><span class="pre">BACE_1_ligand.pdbqt</span></code> is available in <code class="docutils literal notranslate"><span class="pre">solution</span></code> directory.</p>
</section>
<section id="optional-generating-affinity-maps-for-autodock-ff">
<h4>3. (Optional) Generating affinity maps for AutoDock FF<a class="headerlink" href="#optional-generating-affinity-maps-for-autodock-ff" title="Permalink to this headline"></a></h4>
<p>Now, we have to define the grid space for the docking, typically, a 3D box around a the potential binding site of a receptor. During this step, we will create the input file for AutoGrid4, which will create an affinity map file for each atom types. The grid parameter file specifies an AutoGrid4 calculation, including the size and location of the grid, the atom types that will be used, the coordinate file for the rigid receptor, and other parameters for calculation of the grids.</p>
<p>To prepare the gpf file for AutoGrid4, your can use the <code class="docutils literal notranslate"><span class="pre">prepare_gpf.py</span></code> command line tool. This Python script is available here: <code class="docutils literal notranslate"><span class="pre">&lt;autodock-vina_directory&gt;/example/autodock_scripts</span></code>. However, no extra maps are needed for the <code class="docutils literal notranslate"><span class="pre">G0</span></code> and <code class="docutils literal notranslate"><span class="pre">CG0</span></code> atoms because, for sake of evaluation of ligand-protein interaction, they are considered as normal carbon atoms. Therefore, C maps are used in their place and so we are going to ignore those atoms by manually specifying the ligand atom types <code class="docutils literal notranslate"><span class="pre">-p</span> <span class="pre">ligand_types='A,C,OA,N,HD'</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pythonsh ../../autodock_scripts/prepare_gpf.py -l BACE_1_ligand.pdbqt <span class="se">\</span>
           -r BACE_1_receptor.pdbqt -y -p <span class="nv">ligand_types</span><span class="o">=</span><span class="s1">&#39;A,C,OA,N,HD&#39;</span> <span class="se">\</span>
           -p <span class="nv">npts</span><span class="o">=</span><span class="s1">&#39;54,54,54&#39;</span>
</pre></div>
</div>
<p>The option <code class="docutils literal notranslate"><span class="pre">-y</span></code> specifies that we want to center automatically the grid around the ligand. For more information about <code class="docutils literal notranslate"><span class="pre">prepare_gpf.py</span></code>, type <code class="docutils literal notranslate"><span class="pre">pythonsh</span> <span class="pre">prepare_gpf.py</span> <span class="pre">-h</span></code>. At the end you should obtain the following GPF file <code class="docutils literal notranslate"><span class="pre">1iep_receptor.gpf</span></code> containing those lines:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Content of the grid parameter file (<strong>BACE_1_receptor.gpf</strong>) for the receptor BACE (<strong>BACE_1_receptor.pdbqt</strong>)</span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">npts 54 54 54                        # num.grid points in xyz</span>
<span class="go">gridfld BACE_1_receptor.maps.fld     # grid_data_file</span>
<span class="go">spacing 0.375                        # spacing(A)</span>
<span class="go">receptor_types A C NA OA N SA HD     # receptor atom types</span>
<span class="go">ligand_types A C OA N HD             # ligand atom types</span>
<span class="go">receptor BACE_1_receptor.pdbqt       # macromolecule</span>
<span class="go">gridcenter 30.103 6.152 15.584       # xyz-coordinates or auto</span>
<span class="go">smooth 0.5                           # store minimum energy w/in rad(A)</span>
<span class="go">map BACE_1_receptor.A.map            # atom-specific affinity map</span>
<span class="go">map BACE_1_receptor.C.map            # atom-specific affinity map</span>
<span class="go">map BACE_1_receptor.OA.map           # atom-specific affinity map</span>
<span class="go">map BACE_1_receptor.N.map            # atom-specific affinity map</span>
<span class="go">map BACE_1_receptor.HD.map           # atom-specific affinity map</span>
<span class="go">elecmap BACE_1_receptor.e.map        # electrostatic potential map</span>
<span class="go">dsolvmap BACE_1_receptor.d.map              # desolvation potential map</span>
<span class="go">dielectric -0.1465                   # &lt;0, AD4 distance-dep.diel;&gt;0, constant</span>
</pre></div>
</div>
</div>
<p>After creating the GPF file, and now we can use the <code class="docutils literal notranslate"><span class="pre">autogrid4</span></code> command to generate the different map files that will be used for the molecular docking:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ autogrid4 -p BACE_1_receptor.gpf -l BACE_1_receptor.glg
</pre></div>
</div>
<p>From this command you should have generated the following files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1iep_receptor.maps.fld       # grid data file</span>
<span class="go">1iep_receptor.*.map          # affinity maps for A, C, HD, N, OA atom types</span>
<span class="go">1iep_receptor.d.map          # desolvation map</span>
<span class="go">1iep_receptor.e.map          # electrostatic map</span>
</pre></div>
</div>
</section>
<section id="running-autodock-vina">
<h4>4. Running AutoDock Vina<a class="headerlink" href="#running-autodock-vina" title="Permalink to this headline"></a></h4>
<section id="a-using-autodock4-forcefield">
<h5>4.a. Using AutoDock4 forcefield<a class="headerlink" href="#a-using-autodock4-forcefield" title="Permalink to this headline"></a></h5>
<p>When using the AutoDock4 forcefield, you only need to provide the affinity maps and the ligand, while specifying that the forcefield used will be AutoDock4 using the option <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">ad4</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --ligand BACE_1_ligand.pdbqt --maps BACE_1_receptor --scoring ad4 <span class="se">\</span>
       --exhaustiveness <span class="m">32</span> --out BACE_1_ligand_ad4_out.pdbqt
</pre></div>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">BACE_1_ligand_ad4_out.pdbqt</span></code>.</p>
</section>
<section id="b-using-vina-forcefield">
<h5>4.b. Using Vina forcefield<a class="headerlink" href="#b-using-vina-forcefield" title="Permalink to this headline"></a></h5>
<p>As well as for the fully rigid molecular docking, you only need to specify the center and dimensions (in Angstrom) of the grid. Here, instead of specifying each parameters for the grid box using the arguments <code class="docutils literal notranslate"><span class="pre">--center_x,</span> <span class="pre">--center_y,</span> <span class="pre">--center_z</span></code> and <code class="docutils literal notranslate"><span class="pre">--size_x,</span> <span class="pre">--size_y,</span> <span class="pre">--size_z</span></code>, we will also store all those informations in a text file <code class="docutils literal notranslate"><span class="pre">BACE_1_receptor_vina_box.txt</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Content of the config file (<strong>BACE_1_receptor_vina_box.txt</strong>) for AutoDock Vina</span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">center_x = 30.103</span>
<span class="go">center_y = 6.152</span>
<span class="go">center_z = 15.584</span>
<span class="go">size_x = 20</span>
<span class="go">size_y = 20</span>
<span class="go">size_z = 20</span>
</pre></div>
</div>
</div>
<p>However, when using the Vina forcefield, you will need to specify the receptor <code class="docutils literal notranslate"><span class="pre">BACE_1_receptor.pdbqt</span></code> (needed to compute internally the affinity maps). To perform the same docking experiment but using Vina forcefield run the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vina --receptor BACE_1_receptor.pdbqt --ligand BACE_1_ligand.pdbqt <span class="se">\</span>
       --config BACE_1_receptor_vina_box.txt <span class="se">\</span>
       --exhaustiveness <span class="m">32</span> --out BACE_1_ligand_vina_out.pdbqt
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Alternatively, you can use the Vinardo forcefield by adding the <code class="docutils literal notranslate"><span class="pre">--scoring</span> <span class="pre">vinardo</span></code> option.</p>
</div>
<p>Running AutoDock Vina will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">BACE_1_ligand_vina_out.pdbqt</span></code>.</p>
</section>
</section>
<section id="results">
<h4>5. Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please don’t forget that energy scores giving by the AutoDock and Vina forcefield are not comparable between each other.</p>
</div>
<section id="a-using-autodock-forcefield">
<h5>5.a. Using AutoDock forcefield<a class="headerlink" href="#a-using-autodock-forcefield" title="Permalink to this headline"></a></h5>
<p>The predicted free energy of binding should be about <code class="docutils literal notranslate"><span class="pre">-13</span> <span class="pre">kcal/mol</span></code> for the best pose and should corresponds to the crystallographic pose <code class="docutils literal notranslate"><span class="pre">BACE_1_ligand.mol2</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : ad4</span>
<span class="go">Ligand: BACE_1_ligand.pdbqt</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Reading AD4.2 maps ... done.</span>
<span class="go">Performing docking (random seed: -226896966) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -12.98          0          0</span>
<span class="go">   2       -12.18      1.046      1.292</span>
<span class="go">   3       -12.16      1.719      3.126</span>
<span class="go">   4       -10.92      2.008      3.019</span>
<span class="go">   5       -10.35      3.209      5.331</span>
<span class="go">   6       -9.841      3.061      4.709</span>
<span class="go">   7       -9.476       3.08      8.727</span>
<span class="go">   8       -9.094      3.794       5.73</span>
<span class="go">   9       -8.438       3.43      8.918</span>
</pre></div>
</div>
</section>
<section id="id2">
<h5>5.b. Using Vina forcefield<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h5>
<p>Using the vina forcefield, you should obtain a similar output from Vina with the best score around <code class="docutils literal notranslate"><span class="pre">-11</span> <span class="pre">kcal/mol</span></code>. Using the Vina scoring function, the best pose shows also an excellent overlap with the crystallographic coordinates.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Scoring function : vina</span>
<span class="go">Rigid receptor: BACE_1_receptor.pdbqt</span>
<span class="go">Ligand: BACE_1_ligand.pdbqt</span>
<span class="go">Center: X 30.103 Y 6.152 Z 15.584</span>
<span class="go">Size: X 20 Y 20 Z 20</span>
<span class="go">Grid space: 0.375</span>
<span class="go">Exhaustiveness: 32</span>
<span class="go">CPU: 0</span>
<span class="go">Verbosity: 1</span>

<span class="go">Computing Vina grid ... done.</span>
<span class="go">Performing docking (random seed: -1673486704) ...</span>
<span class="go">0%   10   20   30   40   50   60   70   80   90   100%</span>
<span class="go">|----|----|----|----|----|----|----|----|----|----|</span>
<span class="go">***************************************************</span>

<span class="go">mode |   affinity | dist from best mode</span>
<span class="go">     | (kcal/mol) | rmsd l.b.| rmsd u.b.</span>
<span class="go">-----+------------+----------+----------</span>
<span class="go">   1       -11.17          0          0</span>
<span class="go">   2        -9.66       3.78      7.156</span>
<span class="go">   3       -9.638      3.147      5.394</span>
<span class="go">   4       -9.563      1.416      2.844</span>
<span class="go">   5       -9.442      5.028      8.249</span>
<span class="go">   6       -9.374      2.683      8.933</span>
<span class="go">   7       -9.342      2.713      9.145</span>
<span class="go">   8       -9.226      3.415      5.818</span>
<span class="go">   9       -9.107      4.728      8.382</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-docking_python"></span><section id="python-scripting">
<span id="python-docking"></span><h3>Python scripting<a class="headerlink" href="#python-scripting" title="Permalink to this headline"></a></h3>
<section id="materials-for-this-tutorial">
<h4>Materials for this tutorial<a class="headerlink" href="#materials-for-this-tutorial" title="Permalink to this headline"></a></h4>
<p>For this tutorial, all the basic material are provided and can be found in the <code class="docutils literal notranslate"><span class="pre">AutoDock-Vina/example/python_scripting</span></code> directory (or on <a class="reference external" href="https://github.com/ccsb-scripps/AutoDock-Vina/tree/develop/example/python_scripting">GitHub</a>).</p>
</section>
<section id="first-example">
<h4>First example<a class="headerlink" href="#first-example" title="Permalink to this headline"></a></h4>
<p>Let’s begin with a very simple example of an AutoDock Vina script. It loads affinity maps for the AutoDock forcefield with their filenames starting by <cite>1iep</cite>, then load a PDBQT file containing a ligand called <cite>1iep_ligand.pdbqt</cite>, score the current pose, minimize it, dock it and save the minimized pose to a PDBQT file called <cite>1iep_ligand_minimized.pdbqt</cite>. For the full documentation about the <cite>Vina</cite> Python package, see <a class="reference internal" href="index.html#vina"><span class="std std-ref">Python documentation</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># My first example with AutoDock Vina in python</span>
<span class="c1">#</span>

<span class="kn">from</span> <span class="nn">vina</span> <span class="kn">import</span> <span class="n">Vina</span>


<span class="n">v</span> <span class="o">=</span> <span class="n">Vina</span><span class="p">(</span><span class="n">sf_name</span><span class="o">=</span><span class="s1">&#39;vina&#39;</span><span class="p">)</span>

<span class="n">v</span><span class="o">.</span><span class="n">set_receptor</span><span class="p">(</span><span class="s1">&#39;1iep_receptor.pdbqt&#39;</span><span class="p">)</span>

<span class="n">v</span><span class="o">.</span><span class="n">set_ligand_from_file</span><span class="p">(</span><span class="s1">&#39;1iep_ligand.pdbqt&#39;</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">compute_vina_maps</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">15.190</span><span class="p">,</span> <span class="mf">53.903</span><span class="p">,</span> <span class="mf">16.917</span><span class="p">],</span> <span class="n">box_size</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>

<span class="c1"># Score the current pose</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">score</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score before minimization: </span><span class="si">%.3f</span><span class="s1"> (kcal/mol)&#39;</span> <span class="o">%</span> <span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Minimized locally the current pose</span>
<span class="n">energy_minimized</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score after minimization : </span><span class="si">%.3f</span><span class="s1"> (kcal/mol)&#39;</span> <span class="o">%</span> <span class="n">energy_minimized</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">v</span><span class="o">.</span><span class="n">write_pose</span><span class="p">(</span><span class="s1">&#39;1iep_ligand_minimized.pdbqt&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Dock the ligand</span>
<span class="n">v</span><span class="o">.</span><span class="n">dock</span><span class="p">(</span><span class="n">exhaustiveness</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">n_poses</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">write_poses</span><span class="p">(</span><span class="s1">&#39;1iep_ligand_vina_out.pdbqt&#39;</span><span class="p">,</span> <span class="n">n_poses</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can find this script in the <cite>example</cite> folder of AutoDock-Vina available on Github. To execute it from a command line, go to your terminal/console/command prompt window. Navigate to the <cite>examples</cite> folder by typing</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> &lt;examples_directory&gt;/python_scripting
<span class="gp">$ </span>python first_example.py
</pre></div>
</div>
<p>Let’s go through the script line by line and see how it works.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">vina</span> <span class="kn">import</span> <span class="n">Vina</span>
</pre></div>
</div>
<p>This line is just for Python to tell it to load the Python package <code class="docutils literal notranslate"><span class="pre">vina</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">Vina</span><span class="p">(</span><span class="n">sf_name</span><span class="o">=</span><span class="s1">&#39;vina&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This line creates the <code class="docutils literal notranslate"><span class="pre">Vina</span></code> object that will be use for the subsequent taks. More precisely, it specifies also the forcefield that will be used for the molecular docking, here the Vina forcefield will be used. In the case, you want to use another forcefield like AutoDock4 or Vinardo, just replace <code class="docutils literal notranslate"><span class="pre">vina</span></code> by <code class="docutils literal notranslate"><span class="pre">ad4</span></code> or <code class="docutils literal notranslate"><span class="pre">vinardo</span></code>. Other options can be define, like the number of cpu that will be used during the molecule docking. By default, Vina will use the avaialble cpus on you machine (<code class="docutils literal notranslate"><span class="pre">cpu=0</span></code>), but you could use only one with <code class="docutils literal notranslate"><span class="pre">cpu=1</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">set_receptor</span><span class="p">(</span><span class="s1">&#39;1iep_receptor.pdbqt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we are loading a PDBQT file called <code class="docutils literal notranslate"><span class="pre">1iep_receptor.pdbqt</span></code> containing the receptor. If necessary, PDBQT file containing the flexible sidechains can be also load at the same time by doing <code class="docutils literal notranslate"><span class="pre">v.set_receptor('1iep_rigid.pdbqt',</span> <span class="pre">'1iep_flex.pdbqt')</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">set_ligand_from_file</span><span class="p">(</span><span class="s1">&#39;1iep_ligand.pdbqt&#39;</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">compute_vina_maps</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">15.190</span><span class="p">,</span> <span class="mf">53.903</span><span class="p">,</span> <span class="mf">16.917</span><span class="p">],</span> <span class="n">box_size</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
</pre></div>
</div>
<p>The next lines are used to first load a PDBQT file containing the ligand called <code class="docutils literal notranslate"><span class="pre">1iep_ligand.pdbqt</span></code> and then compute the affinity maps for each ligand atom types accroding to the Vina forcefield. You might need to read first the tutorial <a class="reference internal" href="index.html#basic-docking"><span class="std std-ref">Basic docking</span></a> to learn how to create a PDBQT file of a ligand. There is a small subility here, the behavior of the <code class="docutils literal notranslate"><span class="pre">compute_vina_maps()</span></code> function changes if the ligand was loaded before or after computing the vina maps. If no ligand was initialized, <code class="docutils literal notranslate"><span class="pre">compute_vina_maps()</span></code> will compute the affinity map for each atom types defined in the Vina forcefield (22 in total). This is very useful when we want to dock ligands in batch (a.k.a virtual screening) but we don’t necessarily know beforehand what atom types will be necessary for thoses ligands. Alternately to <code class="docutils literal notranslate"><span class="pre">set_ligand_from_file()</span></code>, you could also load a molecule using a molecule string in PDBQT format using the <code class="docutils literal notranslate"><span class="pre">set_ligand_from_string()</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Score the current pose</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">score</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score before minimization: </span><span class="si">%.3f</span><span class="s1"> (kcal/mol)&#39;</span> <span class="o">%</span> <span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Next, we simply ask Vina to calculate the energy (<cite>score</cite>) of the current pose using the forcefield defined at the beginning, and retrieve the energy of each component in a numpy array. In this case, we are going to print to the screen only the total energy of the current pose. This task is often useful when you want to get the energy from the specific pose.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Minimized locally the current pose</span>
<span class="n">energy_minimized</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score after minimization : </span><span class="si">%.3f</span><span class="s1"> (kcal/mol)&#39;</span> <span class="o">%</span> <span class="n">energy_minimized</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">v</span><span class="o">.</span><span class="n">write_pose</span><span class="p">(</span><span class="s1">&#39;1iep_ligand_minimized.pdbqt&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This line tells AutoDock Vina to perform a local energy minimization and show the total energy. It is useful sometimes to perform a quick energy minization after manually placing a ligand in a pocket and to remove possible steric clashes with itself and the receptor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dock the ligand</span>
<span class="n">v</span><span class="o">.</span><span class="n">dock</span><span class="p">(</span><span class="n">exhaustiveness</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">n_poses</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">write_poses</span><span class="p">(</span><span class="s1">&#39;1iep_ligand_vina_out.pdbqt&#39;</span><span class="p">,</span> <span class="n">n_poses</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we run the molecular docking. Here we will ask <cite>Vina</cite> to run 32 consecutive Monte-Carlo samplings using the <code class="docutils literal notranslate"><span class="pre">exhaustiveness</span></code> argument and store 20 poses (<code class="docutils literal notranslate"><span class="pre">n_poses</span></code>) during the search. At the end, we will write a PDBQT file called <code class="docutils literal notranslate"><span class="pre">1iep_ligand_vina_out.pdbqt</span></code> containing only the 5 first poses (<code class="docutils literal notranslate"><span class="pre">n_poses</span></code>), ranked by score. Of course, this can be change to 20 to include all the poses that were saved during the calculations, at the condition that the energy difference between the best pose and the 20th pose if less than 3 kcal/mol. This behavior can be changed using the <code class="docutils literal notranslate"><span class="pre">energy_range</span></code> argument to an higher value.</p>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-vina"></span><section id="autodock-vina">
<span id="vina"></span><h3>AutoDock Vina<a class="headerlink" href="#autodock-vina" title="Permalink to this headline"></a></h3>
<section id="module-vina.vina">
<span id="vina-vina"></span><h4>vina.vina<a class="headerlink" href="#module-vina.vina" title="Permalink to this headline"></a></h4>
<dl class="py class">
<dt class="sig sig-object py" id="vina.vina.Vina">
<em class="property"><span class="pre">class</span><span class="w">  </span></em><span class="sig-prename descclassname"><span class="pre">vina.vina.</span></span><span class="sig-name descname"><span class="pre">Vina</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vina'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vina'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a Vina object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sf_name</strong> (<em>str</em>) – Scoring function name to use (Vina or ad4) (default: vina)</p></li>
<li><p><strong>cpu</strong> (<em>int</em>) – Number of CPU to use (default: 0; use all of them)</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed (default: 0; ramdomly choosed)</p></li>
<li><p><strong>no_refine</strong> (<em>boolean</em>) – when receptor is provided, do not use explicit receptor atoms
(instead of precalculated grids) for: (1) local optimization and scoring after docking,
(2) –local_only jobs, and (3) –score_only jobs (default: False)</p></li>
<li><p><strong>verbosity</strong> (<em>int</em>) – verbosity 0: not output, 1: normal, 2: verbose (default: 1; some output)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.__str__" title="Permalink to this definition"></a></dt>
<dd><p>Print basic information about Docking configuration (rigid receptor, flex receptor,
ligands, scoring function, weights, no_refine, box center, box dimensions,
box spacing, box even nelements, seed).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.cite">
<span class="sig-name descname"><span class="pre">cite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.cite" title="Permalink to this definition"></a></dt>
<dd><p>Print citation message.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.info" title="Permalink to this definition"></a></dt>
<dd><p>Return information about the docking configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>Dictionary of information about the docking configuration.</p>
<dl class="simple">
<dt>Information:</dt><dd><p>rigid_receptor (str),
flex_receptor (str),
ligands (list),
scoring_function (str),
weights (tuple),
no_refine (bool),
box_center (list),
box_size (list),
box_spacing (float),
box_even_elements (bool),
seed (int)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.set_receptor">
<span class="sig-name descname"><span class="pre">set_receptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rigid_pdbqt_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flex_pdbqt_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.set_receptor" title="Permalink to this definition"></a></dt>
<dd><p>Set receptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rigid_pdbqt_filename</strong> (<em>str</em>) – rigid pdbqt receptor filename (default: None)</p></li>
<li><p><strong>flex_pdbqt_filename</strong> (<em>str</em>) – flexible residues pdbqt filename (default: None)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.set_ligand_from_file">
<span class="sig-name descname"><span class="pre">set_ligand_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdbqt_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.set_ligand_from_file" title="Permalink to this definition"></a></dt>
<dd><p>Set ligand(s) from a file. The chemical file format must be PDBQT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pdbqt_filename</strong> (<em>str</em><em> or </em><em>list</em>) – Name or list of PDBQT filename(s)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.set_ligand_from_string">
<span class="sig-name descname"><span class="pre">set_ligand_from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdbqt_string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.set_ligand_from_string" title="Permalink to this definition"></a></dt>
<dd><p>Set ligand(s) from a string. The chemical file format must be PDBQT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pdbqt_string</strong> (<em>str</em><em> or </em><em>list</em>) – string or list of PDBQT strings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.set_weights" title="Permalink to this definition"></a></dt>
<dd><p>Set potential weights for vina or ad4 scoring function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weights</strong> (<em>list</em>) – list or weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.compute_vina_maps">
<span class="sig-name descname"><span class="pre">compute_vina_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.375</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_even_voxels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.compute_vina_maps" title="Permalink to this definition"></a></dt>
<dd><p>Compute affinity maps using Vina scoring function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>list</em>) – center position</p></li>
<li><p><strong>box_size</strong> (<em>list</em>) – size of the box in Angstrom</p></li>
<li><p><strong>spacing</strong> (<em>float</em>) – grid spacing (default: 0.375)</p></li>
<li><p><strong>force_even_voxels</strong> (<em>boolean</em>) – Force the number of voxels (NPTS/NELEMENTS) to be an even number
(and forcing the number of grid points to be odd) (default: False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.load_maps">
<span class="sig-name descname"><span class="pre">load_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_prefix_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.load_maps" title="Permalink to this definition"></a></dt>
<dd><p>Load vina or ad4 affinity maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>map_prefix_filename</strong> (<em>str</em>) – affinity map prefix filename</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.write_maps">
<span class="sig-name descname"><span class="pre">write_maps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_prefix_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'receptor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpf_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NULL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fld_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NULL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receptor_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NULL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.write_maps" title="Permalink to this definition"></a></dt>
<dd><p>Write affinity maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map_prefix_filename</strong> (<em>str</em>) – affinity map pathname (path directory + prefix)</p></li>
<li><p><strong>gpf_filename</strong> (<em>str</em>) – grid protein filename (default: NULL)</p></li>
<li><p><strong>fld_filename</strong> (<em>str</em>) – fld filename (default: NULL)</p></li>
<li><p><strong>filename</strong> (<em>receptor</em>) – receptor filename (default: NULL)</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – allow overwriting (default: false)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.write_pose">
<span class="sig-name descname"><span class="pre">write_pose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdbqt_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remarks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.write_pose" title="Permalink to this definition"></a></dt>
<dd><p>Write pose (after randomize or optimize).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdbqt_filename</strong> (<em>str</em>) – output PDBQT filename</p></li>
<li><p><strong>remarks</strong> (<em>str</em>) – REMARKS to add in the PDBQT filename</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – allow overwriting (default: false)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.write_poses">
<span class="sig-name descname"><span class="pre">write_poses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdbqt_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_poses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.write_poses" title="Permalink to this definition"></a></dt>
<dd><p>Write poses from docking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdbqt_filename</strong> (<em>str</em>) – PDBQT file containing poses found</p></li>
<li><p><strong>n_pose</strong> (<em>int</em>) – number of poses to write (default: 9)</p></li>
<li><p><strong>energy_range</strong> (<em>float</em>) – maximum energy difference from best pose (default: 3.0 kcal/mol)</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – allow overwriting (default: false)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.poses">
<span class="sig-name descname"><span class="pre">poses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_poses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.poses" title="Permalink to this definition"></a></dt>
<dd><p>Get poses from docking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_pose</strong> (<em>int</em>) – number of poses to retrieve (default: 9)</p></li>
<li><p><strong>energy_range</strong> (<em>float</em>) – maximum energy difference from best pose (default: 3.0 kcal/mol)</p></li>
<li><p><strong>coordinates_only</strong> (<em>bool</em>) – return coordinates for each pose only</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PDBQT file string or Array of coordinates of poses if coordinates_only=True</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str/ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.energies">
<span class="sig-name descname"><span class="pre">energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_poses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.energies" title="Permalink to this definition"></a></dt>
<dd><p>Get pose energies from docking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_pose</strong> (<em>int</em>) – number of poses to retrieve (default: 9)</p></li>
<li><p><strong>energy_range</strong> (<em>float</em>) – maximum energy difference from best pose (default: 3.0 kcal/mol)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Array of energies from each pose (rows=poses, columns=energies)</p>
<dl class="simple">
<dt>Vina/Vinardo FF:</dt><dd><p>columns=[total, inter, intra, torsions, intra best pose]</p>
</dd>
<dt>AutoDock FF:</dt><dd><p>columns=[total, inter, intra, torsions, -intra]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.randomize">
<span class="sig-name descname"><span class="pre">randomize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.randomize" title="Permalink to this definition"></a></dt>
<dd><p>Randomize the input ligand conformation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unbound_energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.score" title="Permalink to this definition"></a></dt>
<dd><p>Score current pose.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unbound_energy</strong> (<em>float</em>) – Optionally pass the unbound systems energy of the ligand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Array of energies from current pose.</p>
<dl class="simple">
<dt>Vina/Vinardo FF:</dt><dd><p>columns=[total, lig_inter, flex_inter, other_inter, flex_intra, lig_intra, torsions, lig_intra best pose]</p>
</dd>
<dt>AutoDock FF:</dt><dd><p>columns=[total, lig_inter, flex_inter, other_inter, flex_intra, lig_intra, torsions, -lig_intra]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nadarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.optimize" title="Permalink to this definition"></a></dt>
<dd><p>Quick local BFGS energy optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_steps</strong> (<em>int</em>) – Maximum number of local minimization steps (default: 0). When max_steps is equal to 0,
the maximum number of steps will be equal to (25 + num_movable_atoms) / 3).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Array of energies from optimized pose.</p>
<dl class="simple">
<dt>Vina/Vinardo FF:</dt><dd><p>columns=[total, lig_inter, flex_inter, other_inter, flex_intra, lig_intra, torsions, lig_intra best pose]</p>
</dd>
<dt>AutoDock FF:</dt><dd><p>columns=[total, lig_inter, flex_inter, other_inter, flex_intra, lig_intra, torsions, -lig_intra]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nadarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vina.vina.Vina.dock">
<span class="sig-name descname"><span class="pre">dock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exhaustiveness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_poses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rmsd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_evals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.vina.Vina.dock" title="Permalink to this definition"></a></dt>
<dd><p>Docking: global search optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exhaustiveness</strong> (<em>int</em>) – Number of MC run (default: 8)</p></li>
<li><p><strong>n_poses</strong> (<em>int</em>) – number of pose to generate (default: 20)</p></li>
<li><p><strong>min_rmsd</strong> (<em>float</em>) – minimum RMSD difference between poses (default: 1.0 Ansgtrom)</p></li>
<li><p><strong>max_evals</strong> (<em>int</em>) – Maximum number of evaluation (default: 0; use heuristics rules)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-vina.utils">
<span id="vina-utils"></span><h4>vina.utils<a class="headerlink" href="#module-vina.utils" title="Permalink to this headline"></a></h4>
<dl class="py function">
<dt class="sig sig-object py" id="vina.utils.check_file_writable">
<span class="sig-prename descclassname"><span class="pre">vina.utils.</span></span><span class="sig-name descname"><span class="pre">check_file_writable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fnm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vina.utils.check_file_writable" title="Permalink to this definition"></a></dt>
<dd><p>Source: <a class="reference external" href="https://www.novixys.com/blog/python-check-file-can-read-write/">https://www.novixys.com/blog/python-check-file-can-read-write/</a></p>
</dd></dl>

</section>
</section>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Center of Computational Structural Biology (CCSB) - Scripps Research.
      <span class="commit">Revision <code>75f87a4b</code>.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//autodock-vina.readthedocs.io/_/downloads/en/latest/pdf/">pdf</a></dd>
        
          <dd><a href="//autodock-vina.readthedocs.io/_/downloads/en/latest/htmlzip/">html</a></dd>
        
          <dd><a href="//autodock-vina.readthedocs.io/_/downloads/en/latest/epub/">epub</a></dd>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/autodock-vina/?fromdocs=autodock-vina">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/autodock-vina/?fromdocs=autodock-vina">Builds</a>
          </dd>
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>